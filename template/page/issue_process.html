<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>下发详情</title>
    <link type="text/css" rel="stylesheet" href="../apps/com.awspaas.user.apps.clue/css/style.css"/>
    <link type="text/css" rel="stylesheet" href="../apps/com.awspaas.user.apps.clue/css/iview.css"/>
    <link rel="Bookmark" type="image/x-icon" href="../favicon.ico" />
    <link rel="icon" type="image/x-icon" href="../favicon.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />

    <style>
        .ivu-message {
            z-index: 2015!important;
        }
    </style>
</head>
<body>
<div id="issued_detail" v-cloak>
    <div class="header">
        <div class="gap"></div>
        <Row>
            <i-col offset="2" span="22">
                <Tag color="error" class="square-lev" >{{refillData.rw.JJCDDM}}</Tag>
                <label class="title">{{refillData.rw.RWMC}}</label>
            </i-col>
        </Row>
        <Row>
            <i-col offset="2" span="22"><label class="sub-title">{{refillData.rw.RWBH}}</label></i-col>
        </Row>
        <Row>
            <i-col span="2">&nbsp;</i-col>
            <i-col span="15">
                <Row>
                    <i-col span="12"><dl><dt>下发类型：</dt><dd>{{refillData.rw.XFLXDM}}</dd></dl></i-col>
                    <i-col span="12"><dl><dt>下发公开：</dt><dd>{{refillData.rw.SFSMDM}}</dd></dl></i-col>
                </Row>
                <Row>
                    <i-col span="24">&nbsp;</i-col>
                </Row>
                <Row>
                    <i-col span="12"><dl><dt>接收单位：</dt><dd>{{refillData.rw.JSDW_GAJGMC}}</dd></dl></i-col>
                    <i-col span="12"><dl><dt>接收人员：</dt><dd>{{refillData.rw.JSRY_XM}}</dd></dl></i-col>
                </Row>
                <Row>
                    <i-col span="24">&nbsp;</i-col>
                </Row>
                <Row>
                    <i-col span="23"><dl><dt>任务描述：</dt><dd class="long" :title="refillData.rw.RWMS"><div slot="content" class="poptipExplain">{{refillData.rw.RWMS}}</div></dd></dl></i-col>
                </Row>
            </i-col>
            <i-col span="1" class="vertical-divider">&nbsp;</i-col>
            <i-col span="4">
                <Row>
                    <i-col span="24"><dl><dt>下发时间：</dt><dd>{{refillData.rw.XFSJ}}</dd></dl></i-col>
                </Row>
                <Row>
                    <i-col span="24">&nbsp;</i-col>
                </Row>
                <Row>
                    <i-col span="24"><dl><dt>下发单位：</dt><dd>{{refillData.rw.XFDW_GAJGMC}}</dd></dl></i-col>
                </Row>
                <Row>
                    <i-col span="24">&nbsp;</i-col>
                </Row>
                <Row>
                    <i-col span="24"><dl><dt>下发人员：</dt><dd>{{refillData.rw.XFRY_XM}}</dd></dl></i-col>
                </Row>
                <Row>
                    <i-col span="24">&nbsp;</i-col>
                </Row>
                <Row>
                    <i-col span="24">
                        <dl>
                            <dt> 下发状态：</dt>
                            <dd>
                                    <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='待签收'">
                                        <div class="round" style="background-color: #09f;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='回退'">
                                        <div class="round" style="background-color: #f56c6c;" ></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='驳回'">
                                        <div class="round" style="background-color: #f56c6c;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='中止'">
                                        <div class="round" style="background-color: #cccccc;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='已签收'">
                                        <div class="round" style="background-color: #67c23a;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='沟通中'">
                                        <div class="round" style="background-color: #e6a23c;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='转派中'">
                                        <div class="round" style="background-color: #67c23a;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='转派成功'">
                                        <div class="round" style="background-color: #0099ff;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='转派失败'">
                                        <div class="round" style="background-color: #cccccc;"></div>
                                    </span>
                                <span style="display:inline-block"  v-if="refillData.rw.RWZTDM==='关闭'">
                                        <div class="round" style="background-color: #cccccc;"></div>
                                    </span>
                                <span id="zt">{{refillData.rw.RWZTDM}}</span>
                            </dd>
                        </dl>
                    </i-col>
                </Row>
            </i-col>
        </Row>
    </div>
    <div class="content">
        <Collapse v-model="collapse">
            <Panel name="1"  v-if="refillData.fj.length > 0">
                关联附件
                <div slot="content">
                    <Row>
                        <i-col span="6" v-for="(item,index) in refillData.fj" :key="index">
                            <div style="padding:15px">
                                    <span class="block_level"  v-if="item.FJLX==='xlsx'||item.FJLX==='xls'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/excel.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else-if="item.FJLX==='doc'||item.FJLX==='docx'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/word.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else-if="item.FJLX === 'pptx'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/ppt.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else-if="item.FJLX === 'png'||item.FJLX === 'jpg'||item.FJLX === 'jpeg'||item.FJLX === 'gif'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/image.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else-if="item.FJLX === 'mp4'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/video.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else-if="item.FJLX === 'zip'||item.FJLX === 'rar'||item.FJLX === '7z'">
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/zip.png" class="file-icon">
                                    </span>
                                <span class="block_level"  v-else>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/unknown.png" class="file-icon">
                                    </span>
                                <span class="file-name" :title="item.FJMC">{{item.FJMC}}</span>
                                <span class="file-download" @click="downLoadFile(item.FJMC,item.GLYWBH)">下载</span>
                            </div>
                        </i-col>
                    </Row>
                </div>
            </Panel>
            <Panel name="2" v-show="relevanceClueTable.showPanel">
                关联线索
                <div slot="content">
                    <Row v-show="relevanceClueTable.showPanel">
                        <sy-table
                                ref="relevanceClueTable"
                                :url="relevanceClueTable.url"
                                :columns="relevanceClueTable.columns"
                                :query-params="relevanceClueTable.searchParams"
                                :on-load-success="relevanceClueTable.onLoadSuccess"
                                :pager-page-size="5">
                        </sy-table>
                    </Row>
                </div>
            </Panel>
            <Panel name="3" v-if="relevanceLogisticsTable.showPanel">
                关联物流
                <div slot="content">
                    <sy-table
                            ref="relevanceLogistics"
                            :url="relevanceLogisticsTable.url"
                            :columns="relevanceLogisticsTable.columns"
                            :query-params="relevanceLogisticsTable.searchParams"
                            :on-load-success="relevanceLogisticsTable.onLoadSuccess"
                            :pager-page-size="5"
                            :pager-page-size-opts="[5]">
                    </sy-table>
                </div>
            </Panel>
            <Panel name="4" v-if="relevanceEscapeeTable.showPanel">
                关联逃犯
                <div slot="content">
                    <sy-table
                            ref="relevanceEscapee"
                            :url="relevanceEscapeeTable.url"
                            :columns="relevanceEscapeeTable.columns"
                            :query-params="relevanceEscapeeTable.searchParams"
                            :on-load-success="relevanceEscapeeTable.onLoadSuccess"
                            :pager-page-size="5"
                            :pager-page-size-opts="[5]">
                    </sy-table>
                </div>
            </Panel>
            <Panel name="5" v-show="relevanceAJTable.showPanel">
                关联案件
                <!-- 关联案件表格 -->
                <div slot="content">
                    <Row v-show="relevanceAJTable.showPanel">
                        <sy-table
                                ref="relevanceAJTable"
                                :url="relevanceAJTable.url"
                                :columns="relevanceAJTable.columns"
                                :query-params="relevanceAJTable.searchParams"
                                :on-load-success="relevanceAJTable.onLoadSuccess"
                                :pager-page-size="5">
                        </sy-table>
                    </Row>
                </div>
            </Panel>
            <Panel name="6" v-show="relevanceCBTable.showPanel">
                关联串并
                <!-- 关联串并信息表格 -->
                <div slot="content">
                    <Row v-show="relevanceCBTable.showPanel">
                        <sy-table
                                ref="relevanceCBTable"
                                :url="relevanceCBTable.url"
                                :columns="relevanceCBTable.columns"
                                :query-params="relevanceCBTable.searchParams"
                                :on-load-success="relevanceCBTable.onLoadSuccess"
                                :pager-page-size="5">
                        </sy-table>
                    </Row>
                </div>
            </Panel>

            <Panel name="7">
                即时通讯
                <div slot="content">
                    <Row class="head_picture">
                        <div class="buttonBox" v-model="communicationHead">
                                <span
                                        style="margin-left:30px"
                                        v-for="(item,index) in communicationHead"
                                        :key="index"
                                        @click="clickPhoto(item.value)">
                                    <Avatar :src='item.img' :title='item.label' :class="bjys==item.value?'photoFrame':''" />
                                </span>
                            <div class="communicate_btn"  v-for="(item,index) in btnList" :key="index">
                                <i-button type="primary" @click="returnHandler(item.handler)">
                                    {{item.name}}
                                </i-button>
                            </div>
                        </div>
                    </Row>
                    <Scroll class='talk_back'  v-if="communication" height=500 >
                        <Row v-for="(item,index) in processRecord" :key="index">
                            <i-col span="24" class="talk_time">
                                {{item.DJSJ}}
                            </i-col>
                            <div class="talk_width" v-if="item.XXDJRY_GMSFHM==user.userId">
                                <div :style="thisStyle.key == item.GTBH ? thisStyle.styles : {}">
                                    <img :src="item.RYTXDZ" class="policephotos"/>
                                    <span style="float:right">{{item.XXDJRY_XM}}</span>
                                    <Tag color="primary" class="tag_right">{{item.XXDJDW_GAJGMC}}</Tag>
                                    <div class="entry">
                                        <div class="right-entry-trangle"></div>
                                        <div class="right-entry-trangle"></div>
                                        <Row class="talk_bottom">
                                            <span class="talk_action">操作类型：</span>
                                            <span>{{item.CZLXDM}}</span>
                                        </Row>
                                        <Row v-for="(value,key) in item.CZNRMS" :key="index" class="talk_bottom">
                                                <span class="talk_action">{{key}}
                                                    <span v-if='gtnull'>：</span>
                                                </span>
                                            <span class="poptipExplain">{{value}}</span>
                                        </Row>
                                        <Row v-if="item.GTBH!=''" class="talk_bottom">
                                            <span style="color: #0099FF;cursor:pointer;" @click="showDetail(item.GTBH)" v-if="xxxsyc==item.GTBH?!xsyc:xsyc">详细</span>
                                        </Row>
                                        <Row v-if="detailsShow==item.GTBH?show:!show">
                                            <Row>
                                                <div style="font-size:16px; float: left">附件信息</div>
                                                <img src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                                <Row>
                                                    <div>
                                                        <div v-for="(item,index) in detailedEnclosure" :key="index">
                                                            <i-col span="6" style="margin-left:2em;">
                                                                <div style="padding:15px">
                                                                        <span style="display:inline-block"  v-if="item.FJLX==='xlsx'||item.FJLX==='xls'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/excel.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX==='doc'||item.FJLX==='docx'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/word.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'pptx'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/ppt.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'png'||item.FJLX === 'jpg'||item.FJLX === 'jpeg'||item.FJLX === 'gif'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/image.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'mp4'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/video.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'zip'||item.FJLX === 'rar'||item.FJLX === '7z'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/zip.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else>
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/unknown.png" class="file_img">
                                                                        </span>
                                                                    <span class="file_name" title="item.FJMC">{{item.FJMC}}</span>
                                                                    <span class="file_download" @click="downLoadFile(item.FJMC,item.GLYWBH)">下载</span>
                                                                </div>
                                                            </i-col>
                                                        </div>
                                                    </div>
                                                </Row>
                                                <img src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top" >
                                                <span class="gridTitle">关联案事件</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBASJ'+item.GTBH"
                                                        :url="myClueTable.url"
                                                        :columns="myClueTable.columns"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                                <img style="margin-top: 2em;" src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联人员</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBRY'+item.GTBH"
                                                        :url="cbryGridTable.url"
                                                        :columns="cbryGridTable.cbryGrid"
                                                        :query-params="bjson"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                                <img style="margin-top: 2em;" src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top" >
                                                <span class="gridTitle">关联线索</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBXS'+item.GTBH"
                                                        :url="cbxsGridTable.url"
                                                        :columns="cbxsGridTable.cbryGrid"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                                <img style="margin-top: 2em;" src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联物品</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBWP'+item.GTBH"
                                                        :url="seriesCheckGoodsTable.url"
                                                        :columns="seriesCheckGoodsTable.columns"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                            </Row>
                                            <!-- 收起-->
                                            <Row>
                                                <span @click="hideDetail(item.GTBH)" class="tall_retract">收起</span>
                                            </Row>
                                        </Row>

                                    </div>
                                </div>
                            </div>
                            <div stclass="talk_width" v-else>
                                <div style="float:left;	padding-left: 2em;" :style="thisStyle.key == item.GTBH ? thisStyle.styles : {}">
                                    <span>{{item.XXDJRY_XM}}</span>
                                    <Tag color="success" class="tag_left">{{item.XXDJDW_GAJGMC}}</Tag>
                                    <img :src="item.RYTXDZ" class="policephotos" style="float:left;" size="large"/>
                                    <div class="entry_left">
                                        <div class="left-entry-trangle"></div>
                                        <Row class="talk_bottom">
                                            <span class="talk_action">操作类型：</span>
                                            <span>{{item.CZLXDM}}</span>
                                        </Row>
                                        <Row v-for="(value,key) in item.CZNRMS" :key="index" class="talk_bottom">
                                                <span class="talk_action">
                                                    {{key}}
                                                    <span v-if='gtnull'>：</span>
                                                </span>
                                            <span class="poptipExplain">{{value}}</span>
                                        </Row>
                                        <Row v-if="item.GTBH!=''" class="talk_bottom">
                                            <span style="color: #0099FF;cursor:pointer;" @click="showDetail(item.GTBH)" v-if="xxxsyc==item.GTBH?!xsyc:xsyc" :title="xxxsyc">详细</span>
                                        </Row>
                                        <Row v-if="detailsShow==item.GTBH?show:!show">
                                            <Row>
                                                <div class="gridTitle">附件信息</div>
                                                <img src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                                <Row>
                                                    <div>
                                                        <div v-for="(item,index) in detailedEnclosure" :key="index">
                                                            <i-col span="6" style="margin-left:2em;">
                                                                <div style="padding:15px">
                                                                        <span style="display:inline-block"  v-if="item.FJLX==='xlsx'||item.FJLX==='xls'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/excel.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX==='doc'||item.FJLX==='docx'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/word.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'pptx'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/ppt.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'png'||item.FJLX === 'jpg'||item.FJLX === 'jpeg'||item.FJLX === 'gif'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/image.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'mp4'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/video.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else-if="item.FJLX === 'zip'||item.FJLX === 'rar'||item.FJLX === '7z'">
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/zip.png" class="file_img">
                                                                        </span>
                                                                    <span style="display:inline-block"  v-else>
                                                                            <img src="../apps/com.awspaas.user.apps.clue/img/icon/unknown.png" class="file_img">
                                                                        </span>
                                                                    <span class="file_name" title="item.FJMC">{{item.FJMC}}</span>
                                                                    <span class="file_download" @click="downLoadFile(item.FJMC,item.GLYWBH)">下载</span>
                                                                </div>
                                                            </i-col>
                                                        </div>
                                                    </div>
                                                </Row>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联案事件</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBASJ'+item.GTBH"
                                                        :url="myClueTable.url"
                                                        :columns="myClueTable.columns"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                                <img style="margin-top: 2em;" src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联人员</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBRY'+item.GTBH"
                                                        :url="cbryGridTable.url"
                                                        :columns="cbryGridTable.cbryGrid"
                                                        :query-params="bjson"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                                <img style="margin-top: 2em;" src="../apps/com.awspaas.user.apps.clue/img/u21480.png" width="100%"/>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联线索</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBXS'+item.GTBH"
                                                        :url="cbxsGridTable.url"
                                                        :columns="cbxsGridTable.cbryGrid"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                            </Row>
                                            <Row class="talk_top">
                                                <span class="gridTitle">关联物品</span>
                                                <sy-table
                                                        class="talk_top"
                                                        :ref="'CBWP'+item.GTBH"
                                                        :url="seriesCheckGoodsTable.url"
                                                        :columns="seriesCheckGoodsTable.columns"
                                                        :query-params="tabulardata"
                                                        :pager-page-size="5"
                                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                                </sy-table>
                                            </Row>
                                            <!-- 收起-->
                                            <Row>
                                                <span @click="hideDetail(item.GTBH)" class="tall_retract">收起</span>
                                            </Row>
                                        </Row>
                                    </div>
                                </div>
                            </div>
                        </Row>
                    </Scroll>
                </div>
            </Panel>
        </Collapse>
    </div>
    <!-- 回退弹框 -->
    <Modal v-model="backModal"title="驳回">
        <i-form
                ref="backModalForm"
                :model="backModalForm"
                :rules="backModalValidate"
                :label-width="120">
            <Row>
                <form-item style="line-height:90px;text-align:center" label="回退原因" prop="back_reason">
                    <i-col>
                        <i-input v-model="backModalForm.back_reason" type="textarea" />
                    </i-col>
                </form-item>
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="backModal=false">取消</i-button>
            <i-button type="primary" @click="submitBack('backModalForm')">确定</i-button>
        </div>
    </Modal>
    <!-- 转派回退回退弹框 -->
    <Modal v-model="transferbackModal" title="转派回退">
        <i-form
                ref="transferback"
                :model="transferback"
                :rules="transferbackValidate"
                :label-width="120">
            <Row>
                <form-item style="line-height:90px;text-align:center" label="回退原因" prop="transferback_reason">
                    <i-col>
                        <i-input v-model="transferback.transferback_reason" type="textarea" />
                    </i-col>
                </form-item>
            </Row>
            <!-- <Row>
                <form-item  style="line-height:90px;text-align:center" label="回退原因" prop="transferback_reason">
                    <i-col span="20">
                        <i-input v-model="transferback.transferback_reason" type="textarea" />
                    </i-col>
                </form-item > -->
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="transferbackModal=false">取消</i-button>
            <i-button type="primary" @click="submitTransferBack('transferback')">确定</i-button>
        </div>
    </Modal>
    <!-- 回退审批通过弹框 -->
    <Modal v-model="backPassModal"title="回退审批通过">
        <i-form
                ref="backPass"
                :model="backPass"
                :rules="backPassModalValidate"
                :label-width="120">
            <Row>
                <form-item label="通过原因" prop="backpass_reason">
                    <i-input v-model="backPass.backpass_reason" type="textarea"/>
                </form-item>
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="backPassModal=false">取消</i-button>
            <i-button type="primary" @click="submitBackPass('backPass')">确定</i-button>
        </div>
    </Modal>
    <!-- 回退审批驳回弹框 -->
    <Modal v-model="backEndModal" title="回退审批驳回">
        <i-form
                ref="backEnd"
                :model="backEnd"
                :rules="backEndModalValidate"
                :label-width="120">
            <Row>
                <form-item label="驳回原因" prop="backend_reason">
                    <i-input v-model="backEnd.backend_reason" type="textarea"/>
                </form-item>
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="backEndModal=false">取消</i-button>
            <i-button type="primary" @click="submitBackEnd('backEnd')">确定</i-button>
        </div>
    </Modal>
    <!-- 反馈/批复弹框 -->
    <Modal v-model="feedbackModal" :title="modalname" width=80>
        <div>
            <div>
                <i-form ref="feedbackdata"
                        v-bind:label-width="120"
                        :model="feedbackdata"
                        :rules="feedbackdataInline">
                    <Row>
                        <i-col span="24">
                            <form-item label="沟通信息" prop="FKXX">
                                <i-input type="textarea" v-model="feedbackdata.FKXX"></i-input>
                            </form-item>
                        </i-col>
                        <i-col span="24">
                            <form-item label="信息附件">
                                <Upload
                                        ref="upload"
                                        :show-upload-list="false"
                                        :default-file-list="defaultList"
                                        :on-success="handleSuccess"
                                        :max-size="102400"
                                        :on-format-error="handleFormatError"
                                        :on-exceeded-size="handleMaxSize"
                                        :before-upload="handleBeforeUpload"
                                        multiple
                                        type="drag"
                                        action="./uf?appId=com.awspaas.user.apps.clue&sid=<#sid>&groupValue=clue&fileValue=<#UUID>&repositoryName=sy"
                                        style="display: inline-block;width:58px;">
                                    <div style="width: 58px;height:58px;line-height: 58px;">
                                        <Icon type="ios-add" size="20"></Icon>
                                    </div>
                                </Upload>
                                <div class="demo-upload-list" v-for="(item,index) in uploadList" :key="item.value">
                                    <div :title="item.name" v-if="matchType(item)==='xlsx'||matchType(item)==='xls'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/excel.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div :title="item.name" v-if="matchType(item) === 'doc'||matchType(item)=== 'docx'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/word.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div :title="item.name" v-if="matchType(item) === 'pptx'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/ppt.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div :title="item.name" v-if="matchType(item) === 'png'||matchType(item) === 'jpg'||matchType(item) === 'jpeg'||matchType(item) === 'gif'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/image.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div :title="item.name" v-if="matchType(item) === 'mp4'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/video.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div :title="item.name" v-if="matchType(item) === 'zip'||matchType(item) === 'rar'||matchType(item) === '7z'">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/zip.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                    <div v-else :title="item.name">
                                        <Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
                                        <img src="../apps/com.awspaas.user.apps.clue/img/icon/unknown.png">
                                        <p>附件{{index + 1}}</p>
                                    </div>
                                </div>
                                <Tooltip
                                        content="最多上传15个附件，每个附件最大100M"
                                        style="position: absolute;top: 16px;left: -3.5%;">
                                    <Icon type="ios-information-circle-outline" size="20"/>
                                </Tooltip>
                            </form-item>
                        </i-col>
                    </Row>
                </i-form>
                <Row class="popout_addtop">
                    <Row>
                        <span class="popout_addaj">添加关联</span>
                        <i-button @click="callModal()" class="related_btn">
                            <Icon type="ios-add" style="color: #000"></Icon>关联案件
                        </i-button>
                        <Modal v-model="addAjmodal" title="关联案件" width="70%" @on-cancel="cancel" footer-hide :closable="false">
                            <div slot="header" style="height: 35px;line-height: 35px;">
                                <label class="gridTitle">关联案件</label>
                                <div style="float:right;">
                                    <i-button @click="addAjmodal=false">取消</i-button>
                                    <i-button type="primary" @click="addAjtab()">确定</i-button>
                                </div>
                            </div>
                            <Row>
                                <i-form ref="addaj" v-model="addaj" v-bind:label-width="30">
                                    <i-col span="5" label>
                                        <form-item>
                                            <i-input v-model="addaj.ASJBH" placeholder="请输入案件编号"></i-input>
                                        </form-item>
                                    </i-col>
                                    <i-col span="5" label>
                                        <form-item>
                                            <sy-tree ref="caseDepartment" tablename="CODE_GXS" title="请选择立案单位" v-model="addaj.LADW_GAJGJGDM" @change="addaj.LADW_GAJGJGDM=$event" placeholder="请输入立案单位"></sy-tree>
                                            <!-- <ck-tree table-name="CODE_GXS" title="请选择立案单位" v-model="addaj.LADW_GAJGJGDM" @change="addaj.LADW_GAJGJGDM=$event" placeholder="请输入立案单位"></sy-tree> -->
                                        </form-item>
                                    </i-col>
                                    <i-col span="5" label>
                                        <form-item>
                                            <sy-tree ref="caseType" tablename="CODE_AJLB_XL" title="请选择案件类别" v-model="addaj.ZATZ_JYQK" @change="addaj.ZATZ_JYQK=$event" placeholder="请输入案件类别"></sy-tree>
                                        </form-item>
                                    </i-col>
                                    <i-col span="5" label>
                                        <form-item>
                                            <date-picker type="daterange" style="width:100%;" confirm v-model="addaj['LARQ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addaj['LARQ~11']=$event"></date-picker>
                                        </form-item>
                                    </i-col>
                                    <i-col span="4">
                                        <form-item>
                                            <i-button type="primary" @click="searchAllCase()">查询</i-button>
                                            <i-button @click="resetForm('addaj')">清空</i-button>
                                        </form-item>
                                    </i-col>
                                </i-form>
                            </Row>
                            <sy-table
                                    id-field="ASJBH"
                                    ref="seriesCase"
                                    :url="seriesCase.url"
                                    :columns="seriesCase.columns"
                                    :query-params="seriesCaseParams"
                                    :pager-page-size="5"
                                    :pager-page-size-opts="[5, 10, 20, 30]">
                            </sy-table>
                        </Modal>
                        <i-button @click="callGoodsModal" class="related_btn">
                            <Icon type="ios-add" style="color: #000"></Icon>关联物品
                            <Modal v-model="addGoodsModal" width="70%" footer-hide :closable="false">
                                <div slot="header" style="height: 35px;line-height: 35px;">
                                    <label class="gridTitle">关联物品</label>
                                    <div style="float:right;">
                                        <i-button @click="addGoodsModal=false">取消</i-button>
                                        <i-button type="primary" @click="addGoodsTab()">确定</i-button>
                                        <!-- <i-button type="success" @click="handleMoveModal = true">手动添加</i-button> -->
                                    </div>
                                </div>
                                <Row>
                                    <!-- 手动添加物品 -->
                                    <Modal title="物品分类" v-model="handleMoveModal" width="400px">
                                        <i-form ref="handleMove" v-model="handleMove" v-bind:label-width="80">
                                            <Row>
                                                <i-col span="24">
                                                    <form-item label="涉案物品">
                                                        <i-select v-model="handleMove.SAWP" placeholder="请选择涉案物品" @on-change="indetifySort">
                                                            <i-option value="01">可疑物品</i-option>
                                                            <i-option value="02">作案物品</i-option>
                                                        </i-select>
                                                    </form-item>
                                                </i-col>
                                                <i-col span="24">
                                                    <form-item label="物品分类">
                                                        <i-select v-model="handleMove.WPZL" @on-open-change="isChooseType()" placeholder="请选择物品分类">
                                                            <i-option v-for="(item,index) in goodsSorting" value="item.value">{{item.label}}</i-option>
                                                        </i-select>
                                                    </form-item>
                                                </i-col>
                                            </Row>
                                        </i-form>
                                    </Modal>
                                    <i-form ref="addGoods" v-model="addGoods" v-bind:label-width="30">
                                        <i-col span="5" label>
                                            <form-item><i-input v-model="addGoods.SAWPBH" placeholder="请输入物品编号"></i-input></form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item>
                                                <sy-tree ref="wpType" title="请选择物品类别" check-strictly tablename="CODE_SAWP" v-model="addGoods.SAWP_SAWPDM" @change="addGoods.SAWP_SAWPDM=$event" placeholder="请输入物品类别"></sy-tree>
                                            </form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item> <date-picker type="daterange" style="width:100%;" confirm v-model="addGoods['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addGoods['DJSJ~11']=$event"></date-picker></form-item>
                                        </i-col>
                                        <i-col span="4">
                                            <form-item>
                                                <i-button type="primary" @click="searchAllGoods()">查询</i-button>
                                                <i-button @click="resetForm('addGoods')">清空</i-button>
                                            </form-item>
                                        </i-col>
                                    </i-form>
                                </Row>
                                <sy-table
                                        id-field="SAWPBH"
                                        ref="seriesGoods"
                                        :url="seriesGoods.url"
                                        :columns="seriesGoods.columns"
                                        :query-params="seriesCaseParams"
                                        :pager-page-size="5"
                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                </sy-table>
                            </Modal>
                        </i-button>
                        <i-button @click="callPersonModal" class="related_btn">
                            <Icon type="ios-add" style="color: #000"></Icon>关联人员
                            <Modal v-model="addPersonModal" width="70%" footer-hide :closable="false">
                                <div slot="header" style="height: 35px;line-height: 35px;">
                                    <label class="gridTitle">关联人员</label>
                                    <div style="float:right;">
                                        <i-button @click="addPersonModal=false">取消</i-button>
                                        <i-button type="primary" @click="addPersonTab()">确定</i-button>
                                        <!-- <i-button type="success">手动添加</i-button> -->
                                    </div>
                                </div>
                                <Row>
                                    <i-form ref="addPerson" v-model="addPerson" v-bind:label-width="30">
                                        <i-col span="5" label>
                                            <form-item><i-input v-model="addPerson.ASJXGRYBH" placeholder="请输入人员编号或证件号"></i-input></form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item>
                                                <sy-tree ref="hjdz" tablename="CODE_XZQH" v-model="addPerson.HJDZ_DZMC" @change="addPerson.HJDZ_DZMC=$event" placeholder="请输入户籍地区"></sy-tree>
                                            </form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item>
                                                <date-picker type="daterange" style="width:100%;" confirm v-model="addPerson['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addPerson['DJSJ~11']=$event"></date-picker>
                                            </form-item>
                                        </i-col>
                                        <i-col span="4">
                                            <form-item>
                                                <i-button type="primary" @click="searchAllPerson()">查询</i-button>
                                                <i-button @click="resetForm('addPerson')">清空</i-button>
                                            </form-item>
                                        </i-col>
                                    </i-form>
                                </Row>
                                <sy-table
                                        id-field="ASJXGRYBH"
                                        ref="seriesPerson"
                                        :url="seriesPerson.url"
                                        :columns="seriesPerson.columns"
                                        :query-params="seriesCaseParams"
                                        :pager-page-size="5"
                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                </sy-table>
                            </Modal>
                        </i-button>
                        <i-button @click="callClueModal"  class="related_btn">
                            <Icon type="ios-add" style="color: #000"></Icon>关联线索
                            <Modal v-model="addClueModal" title="关联线索"  width="70%" @on-cancel="cancel" footer-hide :closable="false">
                                <div slot="header" style="height: 35px;line-height: 35px;">
                                    <label class="gridTitle">关联线索</label>
                                    <div style="float:right;">
                                        <i-button @click="addClueModal=false">取消</i-button>
                                        <i-button type="primary" @click="addClueTab()">确定</i-button>
                                    </div>
                                </div>
                                <Row>
                                    <i-form ref="addClue" v-model="addClue" v-bind:label-width="30">
                                        <i-col span="5" label>
                                            <form-item>
                                                <i-input v-model="addClue.XSBH" placeholder="请输入线索编号"></i-input>
                                            </form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item prop="XSLXDM">
                                                <i-select v-model="addClue.XSLXDM" codeName="CODE_XSHB_XSLX"  placeholder="请输入线索类型">
                                                    <i-option v-for="item in optiondata.zllx" :value="item.value" :key="item.value">{{item.label}}</i-option>
                                                </i-select>
                                            </form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item prop="XSJBDM">
                                                <i-select v-model="addClue.XSJBDM" codeName="CODE_XSHB_JB" placeholder="请输入线索级别">
                                                    <i-option v-for="item in optiondata.xsjb" :value="item.value" :key="item.value">{{item.label}}</i-option>
                                                </i-select>
                                            </form-item>
                                        </i-col>
                                        <i-col span="5" label>
                                            <form-item>
                                                <date-picker type="daterange" style="width:100%;" confirm v-model="addClue['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addClue['DJSJ~11']=$event"></date-picker>
                                            </form-item>
                                        </i-col>
                                        <i-col span="4">
                                            <form-item>
                                                <i-button type="primary" @click="searchAllClue()">查询</i-button>
                                                <i-button @click="resetForm('addClue')">清空</i-button>
                                            </form-item>
                                        </i-col>
                                    </i-form>
                                </Row>
                                <sy-table
                                        id-field="XSBH"
                                        ref="seriesClue"
                                        :url="seriesClue.url"
                                        :columns="seriesClue.columns"
                                        :query-params="seriesCaseParams"
                                        :pager-page-size="5"
                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                </sy-table>
                            </Modal>
                        </i-button>
                    </Row>
                </Row>
                <Row class="each_cb">
                    <Row v-if="ajcheckshow" class="w_bg">
                        <div class="gl_title">
                            <span>关联案件</span>
                        </div>
                        <sy-table
                                ref="seriesCheckCase"
                                :url="seriesCheckCase.url"
                                :columns="seriesCheckCase.columns"
                                :query-params="seriesCheckCaseParams"
                                :on-load-success="seriesCheckCase.onLoadSuccess"
                                :pager-page-size="5"
                                :pager-page-size-opts="[5, 10, 20, 30]">
                        </sy-table>
                    </Row>
                </Row>
                <Row class="each_cb">
                    <Row  v-if="xscheckshow"  class="w_bg">
                        <div class="gl_title">
                            <span>关联线索</span>
                        </div>
                        <sy-table
                                ref="seriesCheckClue"
                                :url="seriesCheckClue.url"
                                :columns="seriesCheckClue.columns"
                                :query-params="seriesCheckCaseParams"
                                :on-load-success="seriesCheckClue.onLoadSuccess"
                                :pager-page-size="5"
                                :pager-page-size-opts="[5, 10, 20, 30]">
                        </sy-table>
                    </Row>
                </Row>
                <!-- 已经关联的人员 -->
                <Row class="each_cb">
                    <Row v-if="rycheckshow"  class="w_bg">
                        <div class="gl_title">
                            <span>关联人员</span>
                        </div>
                        <sy-table
                                ref="seriesCheckPerson"
                                :url="seriesCheckPerson.url"
                                :columns="seriesCheckPerson.columns"
                                :query-params="seriesCheckCaseParams"
                                :on-load-success="seriesCheckPerson.onLoadSuccess"
                                :pager-page-size="5"
                                :pager-page-size-opts="[5, 10, 20, 30]">
                            ></sy-table>
                    </Row>
                </Row>
                <!-- 已经关联的物品 -->
                <Row class="each_cb">
                    <Row  v-if="wpcheckshow"  class="w_bg">
                        <div class="gl_title">
                            <span>关联物品</span>
                        </div>
                        <sy-table
                                id-field="SAWPBH"
                                ref="seriesCheckGoods"
                                :url="seriesCheckGoods.url"
                                :columns="seriesCheckGoods.columns"
                                :query-params="seriesCheckCaseParams"
                                :on-load-success="seriesCheckGoods.onLoadSuccess"
                                :pager-page-size="5"
                                :pager-page-size-opts="[5, 10, 20, 30]">
                        </sy-table>
                    </Row>
                </Row>
            </div>
        </div>
        <div slot="footer">
            <i-button @click="feedbackModal=false">取消</i-button>
            <i-button type="primary" @click="submitFeedback('feedbackdata')">确定</i-button>
        </div>
    </Modal>
    <!-- 转派弹框 -->
    <!--转派-->
    <Modal title="转派" v-model="transferModal" width="40">
        <i-form
                ref="transferForm"
                :model="transferForm"
                :rules="transferFormValidate"
                :label-width="120">
            <Row>
                <i-col span="14">
                    <form-item label="接收人员" prop="JSRY_XM">
                        <i-select v-model="transferForm.JSRY_XM" style="width:200px">
                            <i-option
                                    v-for="item in personList"
                                    :value="item.value"
                                    :key="item.value"
                            >{{ item.label }}
                            </i-option>
                        </i-select>
                    </form-item>
                </i-col>
                <i-col span="20">
                    <form-item label="转派描述" prop="ZPYY">
                        <i-input
                                v-model="transferForm.ZPYY"
                                type="textarea"
                                :rows="4"
                                placeholder="最多输入1000字"
                        />
                    </form-item>
                </i-col>
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="transferModal=false">取消</i-button>
            <i-button type="primary" @click="submitTransfer('transferForm')">确定</i-button>
        </div>
    </Modal>
    <!-- 评分弹框 -->
    <Modal title="评分" v-model="scoreModal" class-name="vertical-center-modal" width="40">
        <i-form
                ref="LowerhairForm"
                :model="LowerhairForm"
                :rules="LowerhairValidate"
                :label-width="120">
            <Row>
                <i-col>
                    <form-item label="评分等级：" prop="PFDJ">
                        <Rate allow-half v-model="LowerhairForm.PFDJ" :count="xjsl"/>
                    </form-item>
                </i-col>
                <i-col >
                    <form-item label="评分总结：" prop="PFYJ_JYQK" style="margin-top: 2.5em;">
                        <i-input
                                v-model="LowerhairForm.PFYJ_JYQK"
                                type="textarea"
                                :rows="4"
                                placeholder="最多输入1000字"/>
                    </form-item>
                </i-col>
            </Row>
        </i-form>
        <div slot="footer">
            <i-button @click="scoreModal=false">取消</i-button>
            <i-button type="primary" @click="submitAssess('LowerhairForm')">确定</i-button>
        </div>
    </Modal>
</div>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/vue.min.js" ></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/iview.min.js"></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/zh-CN.js"></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/axios.min.js"></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/common.js"></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/sy-table.js"></script>
<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/ck/ck-tree.js"></script>
<script>
    var sid='<#sid>';
    var user=JSON.parse('<#user>');;
    var gtryxx=JSON.parse('<#gtryxx>');
    var glxs=JSON.parse('<#glxs>');
    var processInstIds = "";
    var taskInstIds = "";
    var refillData={
        rw:JSON.parse('<#rw>'),
        fj: '<#fj>' == '' ? [] : JSON.parse('<#fj>')
    };

    var XSBH = "";
    vm = new Vue({
        el:'#issued_detail',
        data:{
            //案件详情url
            ajxq_url:'http://10.118.5.30/zhyy/ajda/initAjda.do?asjbh=',
            //人员详情
            ryxq_url:'http://10.118.5.30/zhyy/sdhc/sdhcSearch.do?zjhm=',
            //物品详情
            wpxq_url:'https://#?ASJBH=',
            //在逃人员详情
            ztxq_url:'http://10.12.221.133/zxyw_zt/ztry/ztryxxzt.do?ztrybh=',
            //在逃人员详细(身份证号)
            ztxq_zjhm_url:'http://10.118.5.30/zhyy/sdhc/sdhcSearch.do?zjhm=',
            //串并中心(外部)
            cbzx_url:'http://10.118.5.30/zjcbzxManage/dist/index.html#/myCba_detail?CBBH=',
            //要默认展开的折叠面板的序号
            arrCollapse: [1,2,3],
            //要默认展开的折叠面板的序号
            collapse: [1,2,3,4,5,6,7],
            user:user,
            //头像背景颜色
            bjys:-1,
            //即时沟通
            communication:false,
            processRecord:[],
            rwzp:[],
            arrCollapse: [1,2,3],//要默认展开的折叠面板的序号
            xxxsyc:-1,
            detailsShow:-1,
            show:true,
            xsyc:true,
            QJRWLZBH:'',
            //回退
            gtnull:false,
            backModal:false,
            backModalForm:{
                back_reason:''
            },
            //转派回退
            transferbackModal:false,
            transferback: {
                transferback_reason: '',
            },
            //回退审批通过与驳回
            backPassModal:false,
            backEndModal:false,
            //回退审批驳回
            backEnd:{
                backend_reason: '',
            },
            //回退审批通过
            backPass:{
                backpass_reason:'',
            },
            //反馈/批复
            modalname:'',
            feedbackModal:false,
            zpsj: "",
            glybh:"",
            transferForm:{
                JSRY_XM: "",
                ZPYY: ""
            },
            personList: [],
            zpList: [],
            communicationHead: [],
            btnList:[],
            xjsl: 10,
            //评分等级
            LowerhairForm:{
                PFDJ:0,
                PFYJ_JYQK:''
            },
            LowerhairValidate:{
                PFDJ: [
                    { required: true,type:'number',message: '此项为必填项', trigger: 'change'},
                    { type: 'number', min: 0.5, message: '评分不能为0', trigger: 'change' }
                ],
                PFYJ_JYQK: [
                    { required: true, message: '此项为必填项', trigger: 'change' }
                ],
            },
            valueHalf: 0,
            clueValidate: {},
            detailData: {
                RWDJ: "",
                RWMC: "",
                RWBH: "",
                SBLXDM: "",
                SFSMDM: "",
                JSDW_GAJGMC: "",
                JSRY_XM: "",
                RWMS: "",
                SBSJ: "",
                SBRY_XM: "",
                SBDW_GAJGMC: "",
                RWZTDM: ""
            },
            detailGrid: {},
            Lowerhair: {
                XFLXDM: ""
            },
            scoreModal: false,
            transferModal: false,
            list1: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10, 10, 10, 10, 10],
            value1: "",
            value2: "1",
            tabs: [],
            //反馈/批复弹框的数据
            feedbackOrReply:'',
            //关联线索编号
            GLXSID:[],
            //附件路径
            filePath:[],
            defaultList: [],
            imgName: "",
            uploadList: [],
            feedbackdata: {
                FKXX:''
            },
            clueValidate: {
                FKXX: [
                    { required: true, message: "此项为必填项", trigger: "change" },
                    { type: 'string', max: 500, message: '最多输入500字', trigger: 'change' }
                ]
            },
            backModalValidate:{
                back_reason:[{
                    required: true,message: '此项为必填项',trigger: 'change'},
                    {
                        type: 'string',max: 1000,message: '最多输入1000字',trigger: 'change'
                    }
                ]
            },
            transferFormValidate: {
                JSRY_XM: [
                    { required: true, message: '此项为必填项', trigger: 'change' },
                ],
                ZPYY: [
                    { required: true, message: '此项为必填项', trigger: 'change' },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' }
                ],
            },
            backEndModalValidate:{
                backend_reason:[
                    { required: true, message: '此项为必填项', trigger: 'change' },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' }
                ]
            },
            backPassModalValidate:{
                backpass_reason:[
                    { required: true, message: '此项为必填项', trigger: 'change' },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' }
                ]
            },
            feedbackdataInline: {
                FKXX: [
                    { required: true, message: '此项为必填项', trigger: 'blur' },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' }
                ],
            },
            transferbackValidate: {
                transferback_reason: [
                    { required: true, message: '此项为必填项', trigger: 'change' },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' },
                ]
            },
            addAjmodal: false,
            addaj: {
                ASJBH: "",
                LADW_GAJGJGDM: "",
                ZATZ_JYQK: "",
                "LARQ~11":""
            },
            addClue:{
                XSBH: "",
                XSJBDM: "",
                XSLXDM: "",
                "DJSJ~11":""
            },
            addPerson:{
                ASJXGRYBH:"",
                HJDZ_DZMC:"",
                "DJSJ~11": ""
            },
            addGoods:{
                SAWPBH:"",
                SAWP_SAWPdm:"",
                "DJSJ~11": ""
            },
            optiondata: {
                zllx:[
                    {value: "01",label: "常规线索"},
                    {value: "02",label: "贩枪线索"},
                    {value: "03",label: "逃犯线索"},
                ],
                xsjb: [
                    {value: "01",label: "A"},
                    {value: "02",label: "B"},
                    {value: "03",label: "C"},
                    {value: "04",label: "D"}
                ],
            },
            addClueModal:false,
            addGoodsModal:false,
            addPersonModal:false,
            //选中后的下方关联表格的显示隐藏
            ajcheckshow: false,
            xscheckshow:false,
            rycheckshow: false,
            wpcheckshow:false,
            detailedEnclosure:[],
            judgeTitle:'反馈',
            //附件panel的显示隐藏
            fjPanel:true,
            seriesCaseParams:{},
            seriesCase:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getAllCase&sid='+sid,
                params:this.seriesCaseParams,
                columns:[
                    {type: "selection",width: 60,align: "center"},
                    { title: '案件编号',key:'ASJBH',tooltip: true,width:240,
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ajxq_url+params.row.ASJBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.ASJBH)
                            ]);
                        }
                    },
                    {title: "案件名称",key: "AJMC",tooltip: "true"},
                    {title: "案件类别",key: "AJLBDM"},
                    {title: "小类案别",key: "ZATZ_JYQK"},
                    {title: "案件发生时间",key: "SLSJ",width:200},
                    {title: "立案日期",key: "LARQ"},
                    {title: "立案单位",key: "LADW_GAJGMC",tooltip: "true"}
                ],
            },
            seriesClue:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getAreaClue&sid='+sid,
                params:this.seriesCaseParams,
                columns:[
                    {type: "selection",width: 60,align: "center"},
                    {title:'线索编号',key:'XSBH',width:240,render:(h,params)=>{
                            let joinStyle = {}, joinText='';
                            if( params.row.GLXSS > 0){
                                joinStyle = {
                                    color:'#fff',
                                    display:'inline-block',
                                    width: '20px',
                                    height: '20px',
                                    backgroundColor: 'rgba(45, 183, 245, 1)',
                                    marginRight:'5px',
                                    textAlign:'center',
                                    borderRadius: '5px',
                                    lineHeight:'20px'
                                };
                                joinText = '串'
                            }else{
                            }
                            return h('div', [
                                h('span',{
                                    style:joinStyle
                                },joinText),
                                h('a',{
                                    attrs: {
                                        href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                        target:'_blank'
                                    }
                                }, params.row.XSBH)
                            ]);
                        },
                    },
                    {title: "线索名称",key: "XSMC",tooltip: "true"},
                    {title: "线索类型",key: "XSLXDM"},
                    {title: "线索级别",key: "XSJBDM"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "登记单位",key: "XXDJDW_GAJGMC",tooltip: "true"},
                ],
            },
            seriesPerson:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getAllPerson&sid='+sid,
                params:this.seriesCaseParams,
                columns:[
                    {type: "selection",width: 60,align: "center"},
                    {title: "人员编号",key: "ASJXGRYBH",tooltip: "true",width:240,},
                    {title: "姓名",key: "XM",tooltip: "true"},
                    {title: "证件号码",key: "CYZJ_ZJHM",
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ryxq_url+params.row.ASJXGRYBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.CYZJ_ZJHM)
                            ]);
                        }
                    },
                    {title: "户籍地区",key: "HJDZ_XZQHDM",tooltip:"true"},
                    {title: "登记时间",key: "DJSJ"},
                ],
            },
            seriesGoods:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getAllGoods&sid='+sid,
                params:this.seriesCaseParams,
                columns:[
                    {type: "selection",width: 60,align: "center"},
                    {title: "物品编号",key: "SAWPBH",tooltip: true,width: 240,
                        //  	render: (h, params) => {
                        //  		return h('div', [
                        //              h('a',{
                        //                  attrs: {
                        //                      href: ''+vm.wpxq_url+params.row.SAWPBH+'',
                        // target:'_blank'
                        //                  }
                        //              }, params.row.SAWPBH)
                        //          ]);
                        //      }
                    },
                    {title: "物品名称",key: "WPMC",tooltip: "true"},
                    {title: "物品类别",key: "SAWP_SAWPDM",tooltip:"true"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "登记单位",key:"XXDJDW_GAJGMC",tooltip:"true"},
                    {title: "特征描述",key:"WPTZMS",tooltip:"true"},
                ],
            },
            //已关联案件
            seriesCheckCaseParams:{},
            seriesCheckCase:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesCase&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckCase.getData().total;
                    if(total == 0){
                        vm.ajcheckshow = false;
                    }
                },
                columns:[
                    { title: '案件编号',key:'ASJBH',tooltip: true,width:240,
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ajxq_url+params.row.ASJBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.ASJBH)
                            ]);
                        }
                    },
                    {title: "案件名称",key: "AJMC",tooltip: "true"},
                    {title: "案件类别",key: "AJLBDM"},
                    {title: "小类案别",key: "ZATZ_JYQK"},
                    {title: "案件发生时间",key: "SLSJ",width: 200},
                    {title: "立案日期",key: "LARQ"},
                    {title: "立案单位", key: "LADW_GAJGMC",tooltip:'true'},
                    {
                        type: "option",
                        title: "操作",
                        width: 100,
                        render: (h, params) => {
                            return h("div", [
                                h("Icon", {
                                    props: {
                                        type: "md-close"
                                    },
                                    style: {
                                        color: "#f00",
                                        fontSize: "16px",
                                        fontWeight: "bold",
                                        cursor: "pointer"
                                    },
                                    on: {
                                        click: () => {
                                            var row = params.row;
                                            vm.deleteSeriesBiz(row,'ASJBH',function(response){
                                                setTimeout(() => {
                                                    vm.$refs['seriesCheckCase'].init();
                                                    vm.$Message.info("删除成功");
                                                }, 1);
                                            });
                                        }
                                    }
                                })
                            ]);
                        }
                    }
                ],
            },
            seriesCheckClue:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesClue&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckClue.getData().total;
                    if(total == 0){
                        vm.xscheckshow = false;
                    }
                },
                columns:[
                    {title:'线索编号',key:'XSBH',render:(h,params)=>{
                            let joinStyle = {}, joinText='';
                            if( params.row.GLXSS > 0){
                                joinStyle = {
                                    color:'#fff',
                                    display:'inline-block',
                                    width: '20px',
                                    height: '20px',
                                    backgroundColor: 'rgba(45, 183, 245, 1)',
                                    marginRight:'5px',
                                    textAlign:'center',
                                    borderRadius: '5px',
                                    lineHeight:'20px'
                                };
                                joinText = '串'
                            }else{
                            }
                            return h('div', [
                                h('span',{
                                    style:joinStyle
                                },joinText),
                                h('a',{
                                    attrs: {
                                        href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                        target:'_blank'
                                    }
                                }, params.row.XSBH)
                            ]);
                        },
                    },
                    {title: "线索名称",key: "XSMC",tooltip: "true"},
                    {title: "线索类型",key: "XSLXDM"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "线索描述",key: "XSMS",tooltip: "true"},
                    {
                        type: "option",
                        title: "操作",
                        width: 100,
                        render: (h, params) => {
                            return h("div", [
                                h("Icon", {
                                    props: {
                                        type: "md-close"
                                    },
                                    style: {
                                        color: "#f00",
                                        fontSize: "16px",
                                        fontWeight: "bold",
                                        cursor: "pointer"
                                    },
                                    on: {
                                        click: () => {
                                            var row = params.row;
                                            vm.deleteSeriesBiz(row,'XSBH',function(response){
                                                setTimeout(() => {
                                                    vm.$refs['seriesCheckClue'].init();
                                                    vm.$Message.info("删除成功");
                                                }, 1);
                                            });
                                        }
                                    }
                                })
                            ]);
                        }
                    }
                ]
            },
            seriesCheckPerson:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesPerson&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckPerson.getData().total;
                    if(total == 0){
                        vm.rycheckshow = false;
                    }
                },
                columns:[
                    {title: "人员编号",key: "ASJXGRYBH",tooltip: "true",width:240,},
                    {title: "证件号码",key: "CYZJ_ZJHM",
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ryxq_url+params.row.CYZJ_ZJHM+'',
                                        target:'_blank'
                                    }
                                }, params.row.CYZJ_ZJHM)
                            ]);
                        }
                    },
                    {title: "姓名",key: "XM"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "户籍地址",key: "HJDZ_XZQHDM",tooltip: "true"},
                    {
                        type: "option",
                        title: "操作",
                        width: 100,
                        render: (h, params) => {
                            return h("div", [
                                h("Icon", {
                                    props: {
                                        type: "md-close"
                                    },
                                    style: {
                                        color: "#f00",
                                        fontSize: "16px",
                                        fontWeight: "bold",
                                        cursor: "pointer"
                                    },
                                    on: {
                                        click: () => {
                                            var row = params.row;
                                            vm.deleteSeriesBiz(row,'ASJXGRYBH',function(response){
                                                setTimeout(() => {
                                                    vm.$refs['seriesCheckPerson'].init();
                                                    vm.$Message.info("删除成功");
                                                }, 1);
                                            });
                                        }
                                    }
                                })
                            ]);
                        }
                    }
                ]
            },
            seriesCheckGoods:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesGoods&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckGoods.getData().total;
                    if(total == 0){
                        vm.wpcheckshow = false;
                    }
                },
                columns:[
                    {title: "物品编号",key: "SAWPBH",tooltip: true,width:240,
                        //  	render: (h, params) => {
                        //  		return h('div', [
                        //              h('a',{
                        //                  attrs: {
                        //                      href: ''+vm.wpxq_url+params.row.SAWPBH+'',
                        // target:'_blank'
                        //                  }
                        //              }, params.row.SAWPBH)
                        //          ]);
                        //      }
                    },
                    {title: "物品名称",key: "WPMC",tooltip: "true"},
                    {title: "物品类别",key: "SAWP_SAWPDM",tooltip:"true"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "登记单位",key:"XXDJDW_GAJGMC"},
                    {title: "特征描述",key:"WPTZMS",tooltip:"true"},
                    {
                        type: "option",
                        title: "操作",
                        width: 100,
                        render: (h, params) => {
                            return h("div", [
                                h("Icon", {
                                    props: {
                                        type: "md-close"
                                    },
                                    style: {
                                        color: "#f00",
                                        fontSize: "16px",
                                        fontWeight: "bold",
                                        cursor: "pointer"
                                    },
                                    on: {
                                        click: () => {
                                            var row = params.row;
                                            vm.deleteSeriesBiz(row,'SAWPBH',function(response){
                                                setTimeout(() => {
                                                    vm.$refs['seriesCheckGoods'].init();
                                                    vm.$Message.info("删除成功");
                                                }, 1);
                                            });
                                        }
                                    }
                                })
                            ]);
                        }
                    }
                ]
            },
            //关联线索
            relevanceClueTable: {
                url: './jd?cmd=com.awspaas.user.apps.clue.getRelevanceClue&sid='+sid,
                searchParams : {'RWBH' : refillData.rw.RWBH},
                showPanel: true,
                columns:[
                    {title:'线索编号',key:'XSBH',width:230,render:(h,params)=>{
                            let joinStyle = {}, joinText='';
                            if( params.row.GLXSS > 0){
                                joinStyle = {
                                    color:'#fff',
                                    display:'inline-block',
                                    width: '20px',
                                    height: '20px',
                                    backgroundColor: 'rgba(45, 183, 245, 1)',
                                    marginRight:'5px',
                                    textAlign:'center',
                                    borderRadius: '5px',
                                    lineHeight:'20px'
                                };
                                joinText = '串'
                            }else{
                            }
                            return h('div', [
                                h('span',{
                                    style:joinStyle
                                },joinText),
                                h('a',{
                                    attrs: {
                                        href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                        target:'_blank'
                                    }
                                }, params.row.XSBH)
                            ]);
                        },
                    },
                    {title:'线索名称',key:'XSMC',width:250,tooltip:true},
                    {title:'线索类型',key:'XSLXDM',tooltip: true},
                    {title:'登记时间',key:'DJSJ',tooltip: true},
                    {title:'线索描述',key:'XSMS',tooltip: true},
                ],
                onLoadSuccess: function(){
                    let total = vm.$refs.relevanceClueTable.getData().total;
                    if(total == 0){
                        vm.relevanceClueTable.showPanel = false;
                    }
                }
            },
            //关联物流
            relevanceLogisticsTable: {
                url: './jd?cmd=com.awspaas.user.apps.clue.getClueRelevanceLogistics&sid='+sid,
                searchParams : {'XSBH' : refillData.rw.XSBH},
                showPanel: true,
                columns:[
                    {title:'物流单号',key:'WLDH',width:220,
                        // render:(h,params)=>{
                        //     return h('div', [
                        //        h('a',{
                        //            attrs: {
                        //                href: ''+vm.wpxq_url+params.row.WLDH+'',
                        //        		target:'_blank'
                        //            }
                        //        }, params.row.WLDH)
                        //     ]);
                        // },
                    },
                    { title: '物品名称',key:'HW_WPMC',tooltip: true },
                    { title: '收件人',key:'SJR_XM',tooltip: true },
                    { title: '联系方式',key:'SJR_LXDH',tooltip: true },
                    { title: '寄件时间',key:'DDSJ',tooltip: true },
                    { title: '收件地区',key:'SJR_CS',tooltip: true },
                    { title: '收件地址',key:'SJR_XZZ_DZMC',tooltip: true }
                ],
                onLoadSuccess: function(){
                    let total = vm.$refs.relevanceLogistics.getData().total;
                    console.log(total);
                    if(total == 0){
                        vm.relevanceLogisticsTable.showPanel = false;
                    }
                }
            },
            //关联逃犯
            relevanceEscapeeTable: {
                url: './jd?cmd=com.awspaas.user.apps.clue.getClueRelevanceEscapee&sid='+sid,
                searchParams : {'XSBH' : refillData.rw.XSBH},
                showPanel: true,
                columns:[
                    {title: "在逃编号",key: "ZTRYBH",
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ztxq_url+params.row.ZTRYBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.ZTRYBH)
                            ]);
                        }
                    },
                    {title: "证件号码",key: "ZJHM",
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ztxq_zjhm_url+params.row.ZJHM+'',
                                        target:'_blank'
                                    }
                                }, params.row.ZJHM)
                            ]);
                        }
                    },
                    {title: "姓名",key: "XM"},

                    {title: "立逃时间",key: "DJSJ",tooltip: "true"},
                    {title: "立逃单位",key: "XXDJDW_GAJGMC"},
                    {title: "户籍地址",key: "HJDZ_DZMC"},
                ],
                onLoadSuccess: function(){
                    debugger;
                    let total = vm.$refs.relevanceEscapee.getData().total;
                    if(total == 0){
                        vm.relevanceEscapeeTable.showPanel = false;
                    }
                }
            },
            //关联案件(外部平台)
            relevanceAJTable: {
                url: './jd?cmd=com.awspaas.user.apps.clue.getRelevanceAJByOther&sid='+sid,
                searchParams : {'RWBH' : refillData.rw.RWBH},
                showPanel: true,
                columns:[
                    { title: '案件编号',key:'ASJBH',tooltip: true,width:240,
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ajxq_url+params.row.ASJBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.ASJBH)
                            ]);
                        }
                    },
                    { title: '案件名称',key:'AJMC',tooltip: true },
                    { title: '案件类别',key:'AJLBDM',tooltip: true },
                    { title: '小类案别',key:'ZATZ_JYQK',tooltip: true },
                    { title: '案发时间',key:'SLSJ',tooltip: true },
                    { title: '立案单位',key:'LADW_GAJGMC',tooltip: true }
                ],
                onLoadSuccess: function(){
                    let total = vm.$refs.relevanceAJTable.getData().total;
                    if(total == 0){
                        vm.relevanceAJTable.showPanel = false;
                    }
                }
            },


            //关联串并(外部平台)
            relevanceCBTable: {
                url: './jd?cmd=com.awspaas.user.apps.clue.getRelevanceCBByOther&sid='+sid,
                searchParams : {'RWBH' : refillData.rw.RWBH},
                showPanel: true,
                columns:[
                    { title: '串并编号',key:'CBBH',tooltip: true,width:240,
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.cbzx_url+params.row.CBBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.CBBH)
                            ]);
                        }
                    },
                    {title:'串并名称',key:'CBMC',tooltip:true},
                    {title:'登记单位',key:'XXCZDW_GAJGMC',tooltip: true},
                    {title:'登记时间',key:'DJSJ',tooltip: true},
                ],
                onLoadSuccess: function(){
                    let total = vm.$refs.relevanceCBTable.getData().total;
                    if(total == 0){
                        vm.relevanceCBTable.showPanel = false;
                    }
                }
            },

            /* -------------- */

            //详细关联人员
            cbryGridTable:{
                url: './jd?cmd=com.awspaas.user.apps.clue.getSeriesPerson&sid='+sid,
                queryParams :this.bjson,
                cbryGrid:[
                    {title:'人员编号',key:'ASJXGRYBH',tooltip:true},
                    {title:'证件号码',key:'CYZJ_ZJHM',
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ryxq_url+params.row.CYZJ_ZJHM+'',
                                        target:'_blank'
                                    }
                                }, params.row.CYZJ_ZJHM)
                            ]);
                        }
                    },
                    {title:'姓名',key:'XM',tooltip: true},
                    {title:'登记时间',key:'DJSJ',tooltip: true},
                    {title:'户籍地址',key:'HJDZ_XZQHDM',tooltip: true}
                ],
            },
            //详细关联案事件
            myClueTable:{
                url: './jd?cmd=com.awspaas.user.apps.clue.getSeriesCase&sid='+sid,
                queryParams :this.tabulardata,
                columns:[
                    { title: '案件编号',key:'ASJBH',tooltip: true,width:240,
                        render: (h, params) => {
                            return h('div', [
                                h('a',{
                                    attrs: {
                                        href: ''+vm.ajxq_url+params.row.ASJBH+'',
                                        target:'_blank'
                                    }
                                }, params.row.ASJBH)
                            ]);
                        }
                    },
                    {title:'案件名称',key:'AJMC',width:250,tooltip:true},
                    {title:'案件类别',key:'AJLBDM',tooltip: true},
                    {title:'小案类别',key:'address',tooltip: true},
                    {title:'受案时间',key:'SLSJ',tooltip: true},
                    {title:'立案时间',key:'LARQ',sortable: true,tooltip: true} ,
                    {title:'立案单位',key:'LADW_GAJGMC',sortable: true,tooltip: true} ,
                ],
            },
            //详细关联线索
            cbxsGridTable:{
                url: './jd?cmd=com.awspaas.user.apps.clue.getSeriesClue&sid='+sid,
                queryParams :this.tabulardata,
                cbryGrid:[
                    {title:'线索编号',key:'XSBH',width:230,render:(h,params)=>{
                            let joinStyle = {}, joinText='';
                            if( params.row.GLXSS > 0){
                                joinStyle = {
                                    color:'#fff',
                                    display:'inline-block',
                                    width: '20px',
                                    height: '20px',
                                    backgroundColor: 'rgba(45, 183, 245, 1)',
                                    marginRight:'5px',
                                    textAlign:'center',
                                    borderRadius: '5px',
                                    lineHeight:'20px'
                                };
                                joinText = '串'
                            }else{
                            }
                            return h('div', [
                                h('span',{
                                    style:joinStyle
                                },joinText),
                                h('a',{
                                    attrs: {
                                        href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                        target:'_blank'
                                    }
                                }, params.row.XSBH)
                            ]);
                        },
                    },
                    {title:'线索名称',key:'XSMC',width:250,tooltip:true},
                    {title:'线索类型',key:'XSLXDM',tooltip: true},
                    {title:'登记时间',key:'DJSJ',tooltip: true},
                    {title:'线索描述',key:'XSMS',tooltip: true},
                ],
            },
            seriesCheckGoodsTable:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesGoods&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckGoods.getData().total;
                    if(total == 0){
                        vm.wpcheckshow = false;
                    }
                },
                columns:[
                    {title: "物品编号",key: "SAWPBH",tooltip: true,width:240,
                        //  	render: (h, params) => {
                        //  		return h('div', [
                        //              h('a',{
                        //                  attrs: {
                        //                      href: ''+vm.wpxq_url+params.row.SAWPBH+'',
                        // target:'_blank'
                        //                  }
                        //              }, params.row.SAWPBH)
                        //          ]);
                        //      }
                    },
                    {title: "物品名称",key: "WPMC",tooltip: "true"},
                    {title: "物品类别",key: "SAWP_SAWPDM",tooltip:"true"},
                    {title: "登记时间",key: "DJSJ"},
                    {title: "登记单位",key:"XXDJDW_GAJGMC"},
                    {title: "特征描述",key:"WPTZMS",tooltip:"true"},
                ]
            },
            thisStyle:{
                key:-1,
                styles:{width:'100%'}
            },
            handleMove:{
                WPZL:"",SAWP:""
            },
            handleMoveModal:false,
            goodsSorting:[]
        },
        methods:{
            returnColor(type){
                switch(type){
                    case 'A':
                        return 'red'
                        break;
                    case 'B':
                        return 'blue'
                        break;
                    case 'C':
                        return 'yellow'
                        break;
                    case 'D':
                        return 'orange'
                        break;
                    default:
                        return 'red'
                }
            },
            searchData(json, url, callback) {
                let param = new URLSearchParams();
                param.append("json",JSON.stringify(json));
                axios({
                    url: "./jd?sid="+sid+"&cmd="+url,
                    method: "post",
                    data: param
                }).then(response => {
                    callback(response);
                }).catch(error => {
                    console.log(error);
                });
            },
            showLoadMask(){
                this.$Spin.show({
                    render: (h) => {
                        return h('div',[
                            h('Icon', {
                                'class': 'demo-spin-icon-load',
                                props: {
                                    type: 'ios-loading',
                                    size: 18
                                }
                            }),h('div', '加载中')
                        ])
                    }
                });
            },
            hideLoadMask(){
                this.$Spin.hide();
            },
            returnHandler(name){
                if(name=='sign'){//签收(ok)
                    this.sign();
                }else if(name=='back'){//回退(ok)
                    this.back();
                }else if(name=='feedback'){//沟通-新增-反馈(ok)
                    this.feedbackOrReply='feedback';
                    this.modalname="反馈",
                        this.communication=true;
                    this.feedback();
                }else if(name=='transfer'){//转派(ok)
                    this.transfer();
                }else if(name=='backApprovePass'){//回退审批通过(ok)
                    this.backApprovePass();
                }else if(name=='backApproveEnd'){//回退审批驳回(ok)
                    this.backApproveEnd();
                }else if(name=='transferBack'){//转派回退(ok)
                    this.transferBack();
                }else if(name=='reply'){//沟通-新增-批复(ok)
                    this.feedbackOrReply='reply';
                    this.modalname="批复",
                        this.communication=true;
                    this.reply();
                }else if(name=='assess'){//评分(ok)(接口报0)
                    this.assess();
                }else if(name=='issueAgain'){//继续下发
                    this.issueAgain();
                }
                //return name;
            },
            jsgt() {
                var jsgtrx = gtryxx;
                for (var i = 0; i < jsgtrx.length; i++) {
                    var obj = new Object();
                    obj.label = jsgtrx[i].BLRY_XM;
                    obj.value = jsgtrx[i].RWLZBH;
                    obj.img=jsgtrx[i].RYTXDZ;
                    this.communicationHead.push(obj);
                }
            },
            //显示详情
            showDetail(GTBH)  {
                this.showLoadMask();
                this.detailsShow=GTBH;
                this.xxxsyc=GTBH;
                this.thisStyle.key = GTBH;
                // 'detail'+item.GTBH =false;
                var _this=this;
                var xqdata=[];
                var url='com.awspaas.user.apps.clue.getRelevanceAttachment',
                    json={
                        GLYWBH:GTBH
                    }
                axios({
                    url: "./jd?",
                    method: "post",
                    params: {
                        sid: sid,
                        json: json,
                        cmd: url
                    }
                }).then(response => {
                    _this.detailedEnclosure=response.data.data.rows;
                }).catch(error => {
                    console.log(error);
                });
                let data={
                    YWBH: GTBH,
                };
                let bdata={
                    "gl.YWBH": GTBH,
                };
                this.bjson=bdata;
                this.tabulardata =data;
                let params= {
                    json:JSON.stringify(this.tabulardata)
                };
                this.changValue = 1;
                const ref='CBASJ'+GTBH;
                const CBRY='CBRY'+GTBH;
                const CBXS='CBXS'+GTBH;
                const CBWP='CBWP'+GTBH;
                setTimeout(() => {
                    this.$nextTick(() => {
                        this.$refs[ref][0].init();
                        this.$refs[CBRY][0].init();
                        this.$refs[CBXS][0].init();
                        this.$refs[CBWP][0].init();
                    });
                },10);
                this.hideLoadMask();
            },
            //隐藏详情
            hideDetail(GTBH){
                console.log(GTBH);
                this.detailsShow=-1;
                this.xxxsyc=-1;
                this.thisStyle.key=-1;
            },
            search(){
                this.$refs.myClue[0].init();
                this.$refs.cbryGrid[0].init();
                this.$refs.cbxsGrid[0].init();
            },
            //点击管理员
            clickPhoto(e) {
                this.showLoadMask();
                var RWLZBH = e;
                this.QJRWLZBH=e;
                this.glybh = e;
                this.bjys=e;
                console.log(this.bjys);
                var processDefId = "";
                var activityId = "";
                var processDefIdsj = gtryxx;
                var _this = this;
                for (var i = 0; i < processDefIdsj.length; i++) {
                    if (processDefIdsj[i].RWLZBH == RWLZBH) {
                        processInstIds = processDefIdsj[i].PROCESSINSTID;
                        taskInstIds = processDefIdsj[i].TASKID;
                        ID = processDefIdsj[i].ID;
                        RWBH = processDefIdsj[i].RWBH;
                        processDefId = processDefIdsj[i].PROCESSDEFID;
                        activityId = processDefIdsj[i].ACTIVITYID;
                    }
                };
                var jsonn = {
                    data: {
                        RWLZBH:RWLZBH,

                    },
                    processDefId: processDefId,
                    activityId: activityId
                };
                var url = "com.awspaas.user.apps.clue.getProcessRecord";
                axios({
                    url: "./jd?",
                    method: "post",
                    params: {
                        sid: sid,
                        json: jsonn,
                        cmd: url
                    }
                }).then(response =>{
                    if(response.data.result == 'ok'){
                        var data = response.data.data;
                        if(data.hasOwnProperty("action")){
                            if( data.action.length!=0){
                                if(user.userGxsLev == '3'){//继续下发按钮显示
                                    data.action.some((item, i)=>{
                                        if(item.handler=='issueAgain'){
                                            data.action.splice(i, 1)
                                        }
                                    })
                                }
                                _this.btnList = data.action;
                            }
                        }else{
                            _this.btnList=[];
                        };
                        if(data.hasOwnProperty("record")){
                            if(data.record.length > 0){
                                _this.processRecord = data.record;
                                _this.communication = true;
                            }
                        }
                        for(var i=0;i<_this.processRecord.length;i++){
                            if(_this.processRecord[i].CZNRMS != ''){
                                _this.processRecord[i].CZNRMS = JSON.parse(_this.processRecord[i].CZNRMS)
                            }
                            console.log(_this.processRecord[i].GTBH);
                        };
                        for(var i in data.record.CZNRMS){
                            if(i!=''){
                                gtnull:true
                            }
                        };
                        _this.hideLoadMask();
                    }else{
                        _this.$Message.warning('系统异常，请联系管理员！');
                    }
                }).catch(error =>{
                    console.log(error);
                });
            },
            issueAgain(){
                window.open('./w?cmd=com.awspaas.user.apps.clue.router&classify=issue&action=add&sid='+sid+'&extendParams={"RWBH":"'+RWBH+'"}')
            },
            sign(){
                this.showLoadMask();
                var _this=this;
                _this.showLoadMask();
                var jsonn = {
                    processInstId:processInstIds,
                    taskInstId:taskInstIds,
                    data:{
                        "BO_EU_XSHB_RW_LZ": {
                            "ID":ID,
                            "RWBH": RWBH
                        }
                    }
                };
                var url = "com.awspaas.user.apps.clue.sign";
                this.searchData(jsonn,url,function(response){
                    var data=response.data;
                    _this.hideLoadMask();
                    // window.location.reload();
                    if(data.result=='ok'){
                        _this.$Modal.success({
                            title: data.msg,
                            content: '确定后刷新页面',
                            onOk: () => {
                                window.location.reload();
                            }
                        });
                    }
                })
            },
            back(){
                this.backModal=true;
                this.back_reason='';
            },
            submitBack(name){
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this = this;
                        var jsonn = {
                            processInstId: processInstIds,
                            taskInstId: taskInstIds,
                            data: {
                                "BO_EU_XSHB_RW_LZ": {
                                    "ID": ID,
                                    "RWLZBH":this.backModalForm.QJRWLZBH,
                                    "RWBH": RWBH,
                                    "HTYJ_JYQK": this.backModalForm.back_reason
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.back";
                        this.searchData(jsonn, url,
                            function(response) {
                                var data = response.data;
                                if (data.result == 'ok') {
                                    _this.hideLoadMask();
                                    _this.$Modal.success({
                                        title: data.msg,
                                        content: '确定后刷新页面',
                                        onOk: () => {
                                            window.location.reload();
                                        }
                                    });
                                }
                            })
                    }
                })
            },
            //转派回退
            transferBack(){
                this.transferbackModal=true;
                this.transferback_reason=''
            },
            submitTransferBack(name){
                this.$refs[name].validate((valid) => {
                    if(valid){
                        this.showLoadMask();
                        var _this = this;
                        var jsonn = {
                            processInstId: processInstIds,
                            taskInstId: taskInstIds,
                            data: {
                                "BO_EU_XSHB_RW_LZ": {
                                    "ID": ID,
                                    "RWBH": RWBH,
                                    "HTYJ_JYQK": this.transferback.transferback_reason
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.transferBack";
                        this.searchData(jsonn, url,
                            function(response) {
                                var data = response.data;
                                if (data.result == 'ok') {
                                    _this.hideLoadMask();
                                    _this.$Modal.success({
                                        title: data.msg,
                                        content: '确定后刷新页面',
                                        onOk: () => {
                                            window.location.reload();
                                        }
                                    });
                                }
                            })
                    }
                })
            },
            //回退审批通过与驳回
            backApprovePass(){
                this.backPassModal=true;
                this.backPass.backpass_reason=''
            },
            backApproveEnd(){
                this.backEndModal=true;
                this.backEnd.backend_reason=''
            },
            submitBackPass(name){
                debugger;
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this=this;
                        var jsonn = {
                            processInstId:processInstIds,
                            taskInstId:taskInstIds,
                            data:{
                                "BO_EU_XSHB_RW_LZ": {
                                    "ID":ID,
                                    "RWBH": RWBH,
                                    "HTSPYJ_JYQK": this.backPass.backpass_reason,
                                    "HTSPSFTG_PDBZ":"1"
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.backApprovePass";
                        this.searchData(jsonn,url,function(response){
                            var data=response.data;
                            if(data.result=='ok'){
                                _this.hideLoadMask();
                                _this.$Modal.success({
                                    title: data.msg,
                                    content: '确定后刷新页面',
                                    onOk: () => {
                                        window.location.reload();
                                    }
                                });
                            }
                        })
                    }})
            },
            submitBackEnd(name){
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this=this;
                        var jsonn = {
                            processInstId:processInstIds,
                            taskInstId:taskInstIds,
                            data:{
                                "BO_EU_XSHB_RW_LZ": {
                                    "ID":ID,
                                    "RWBH": RWBH,
                                    "HTSPYJ_JYQK": this.backEnd.backend_reason,
                                    "HTSPSFTG_PDBZ":"0"
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.backApproveEnd";
                        this.searchData(jsonn,url,function(response){
                            var data=response.data;
                            _this.hideLoadMask();
                            window.location.reload();
                            if(data.result=='ok'){
                                _this.hideLoadMask();
                                _this.$Modal.success({
                                    title: data.msg,
                                    content: '确定后刷新页面',
                                    onOk: () => {
                                        window.location.reload();
                                    }
                                });
                            }else{
                                this.$Message.error('This is an error tip');
                            }
                        })
                    }})
            },
            //转让
            transfer(){
                this.transferModal = true
            },
            submitTransfer(name){
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this=this;
                        var jsryName = this.transferForm.JSRY_XM;
                        var zpList = this.zpList;
                        var zpSz = [];
                        for (var i = 0; i < zpList.length; i++) {
                            if (zpList[i].JSRY_GMSFHM == jsryName) {
                                zpSz = zpList[i];
                            }
                        }
                        var jsonn = {
                            processInstId:processInstIds,
                            taskInstId:taskInstIds,
                            data: {
                                BO_EU_XSHB_RW_LZ: {
                                    ID: ID,
                                    JSRY_XM: zpSz.JSRY_XM,
                                    JSRY_GMSFHM: zpSz.JSRY_GMSFHM,
                                    JSRY_LXDH: zpSz.JSRY_LXDH,
                                    JSDW_GAJGMC: zpSz.JSDW_GAJGMC,
                                    JSDW_GAJGJGDM: zpSz.JSDW_GAJGJGDM,
                                    ZPYY: this.transferForm.ZPYY
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.transfer";
                        this.searchData(jsonn, url,
                            function(response) {
                                var data = response.data;
                                if (data.result == 'ok') {
                                    _this.transferModal=false;
                                    _this.hideLoadMask();
                                    _this.$Modal.success({
                                        title: data.msg,
                                        content: '确定后刷新页面',
                                        onOk: () => {
                                            window.location.reload();
                                        }
                                    });
                                }
                            })
                    }
                })
            },
            //评分
            assess() {
                this.scoreModal = true;
                this.LowerhairForm.PFDJ = 0;
                this.LowerhairForm.PFYJ_JYQK = "";
            },
            submitAssess(name){
                console.log(this.$refs[name]);
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this = this;
                        var jsonn = {
                            processInstId: processInstIds,
                            taskInstId: taskInstIds,
                            data: {
                                BO_EU_XSHB_RW_LZ: {
                                    ID: ID,
                                    RWBH: RWBH,
                                    PFDJ: this.LowerhairForm.PFDJ,
                                    PFYJ_JYQK: this.LowerhairForm.PFYJ_JYQK
                                }
                            }
                        };
                        var url = "com.awspaas.user.apps.clue.assess";
                        this.searchData(jsonn, url,
                            function(response) {
                                var data = response.data;
                                if (data.result == 'ok') {
                                    _this.hideLoadMask();
                                    _this.$Modal.success({
                                        title: data.msg,
                                        content: '确定后刷新页面',
                                        onOk: () => {
                                            window.location.reload();
                                        }
                                    });
                                }
                            })
                    }})
            },
            // 反馈/批复
            feedback(){
                this.feedbackModal=true;
            },
            reply(){
                this.feedbackModal=true;
            },
            submitFeedback(name) {
                this.$refs[name].validate((valid) => {
                    if (valid) {
                        this.showLoadMask();
                        var _this=this;
                        var newjson={
                            "RWBH":RWBH,
                            "RWLZBH":this.QJRWLZBH
                        }
                        var transdata = {
                            processInstId:processInstIds,
                            taskInstId:taskInstIds,
                            data: {
                                "BO_EU_XSHB_RW_LZ":{
                                    "ID":ID,
                                    "RWBH":RWBH
                                },
                            }
                        };
                        if(this.feedbackOrReply == 'feedback'){
                            newjson['FKNR_JYQK']=this.feedbackdata.FKXX,
                                transdata.data['BO_EU_XSHB_RW_FK']=newjson
                        }else if(this.feedbackOrReply == 'reply'){
                            newjson['PFYJ_JYQK']=this.feedbackdata.FKXX,
                                transdata.data['BO_EU_XSHB_RW_PF']=newjson
                        }
                        if(_this.GLXSID.length!=0){
                            transdata.data['BO_EU_XSHB_GLYW']={
                                "ID":_this.GLXSID.join()
                            }
                        };
                        if(_this.filePath.length!=0){
                            transdata.data['BO_EU_XSHB_FJ']={
                                FJLJ:_this.filePath.join()
                            }
                        };
                        var url='com.awspaas.user.apps.clue.'+this.feedbackOrReply;
                        this.searchData(transdata,url,function(response){
                            var data=response.data;
                            if(data.result=='ok'){
                                _this.hideLoadMask();
                                _this.$Modal.success({
                                    title: data.msg,
                                    content: '确定后刷新页面',
                                    onOk: () => {
                                        window.location.reload();
                                    }
                                });
                            }
                        })
                    }
                })
            },
            //反馈/批复弹框里面页面的方法
            removeByValue(arr, val) {
                for(var i = 0; i < arr.length; i++) {
                    if(arr[i] == val) {
                        arr.splice(i, 1);
                        break;
                    }
                }
            },
            //关联案件弹框
            callModal() {
                this.addaj.ASJBH='';
                this.addaj.LADW_GAJGJGDM='';
                this.addaj['LARQ~2']='';
                this.addaj['LARQ~3']='';
                var _this = this;
                _this.addAjmodal = true;
                this.seriesCaseParams = {
                    ID: _this.GLXSID.join()
                };
                setTimeout(() => { _this.$refs['seriesCase'].init(); }, 1);
            },
            //关联线索弹框
            callClueModal() {
                this.addClueModal = true;
                for(var key in this.addClue){
                    this.addClue[key]='';
                }
                this.seriesCaseParams = {
                    'ID~10': this.GLXSID.join()
                };
                setTimeout(() => {
                    this.$refs['seriesClue'].init();
                }, 1);
            },
            callGoodsModal(){
                this.addGoodsModal = true;
                for(var key in this.addGoods){
                    this.addGoods[key]='';
                }
                this.seriesCaseParams = {
                    'ID': this.GLXSID.join()
                };
                setTimeout(() => {
                    this.$refs['seriesGoods'].init();
                }, 1);
            },
            callPersonModal(){
                this.addPersonModal = true;
                for(var key in this.addPerson){
                    this.addPerson[key]='';
                }
                this.seriesCaseParams = {
                    'ID': this.GLXSID.join()
                };
                setTimeout(() => {
                    this.$refs['seriesPerson'].init();
                }, 1);
            },
            ok() {},
            cancel() {},
            matchType(item) {
                return item.FJLX==undefined ? item.name.split('.')[1] : item.FJLX;
            },
            //上传附件
            handleRemove(file) {
                const fileList = this.$refs.upload.fileList;
                this.$refs.upload.fileList.splice(fileList.indexOf(file), 1);
                this.filePath.splice(fileList.indexOf(file), 1);
            },
            handleSuccess(res, file, fileList) {
                let msg = res.data.msg;
                let filePath = typeof msg == 'string' ? JSON.parse(res.data.msg).filePath : res.data.msg.filePath;
                this.filePath.push(filePath);
            },
            handleFormatError(file) {
                this.$Notice.warning({
                    title: "错误的文件格式",
                    desc:
                    "文件 " +
                    file.name +
                    " 格式不正确"
                });
            },
            handleMaxSize(file) {
                this.$Notice.warning({
                    title: "文件内容过大",
                    desc: "文件  " + file.name + "超出100M."
                });
            },
            handleBeforeUpload() {
                const check = this.uploadList.length <= 14;
                if (!check) {
                    this.$Notice.warning({
                        title: "最多上传15个附件！"
                    });
                }
                return check;
            },
            searchAllRelate(formname,tablename){
                var json = this[formname];
                for(var key in json) {
                    if(json[key] == '') {
                        delete json[key];
                    }
                }
                json.ID = this.GLXSID.join();
                this.seriesCaseParams = json;
                setTimeout(() => { this.$refs[tablename].init(); }, 1);
            },
            searchAllCase() {
                this.searchAllRelate('addaj','seriesCase');
            },
            searchAllClue(){
                this.searchAllRelate('addClue','seriesClue');
            },
            searchAllPerson(){
                this.searchAllRelate('addPerson','seriesPerson');
            },
            searchAllGoods(){
                this.searchAllRelate('addGoods','seriesGoods');
            },
            addSeriesBiz(idList,ywlxdm,callback){
                let that = this;
                let params = [];
                idList.forEach((item) => {
                    params.push({
                        GLYWBH : item,
                        GLYWLXDM : ywlxdm
                    });
                });
                axios({
                    url:'./jd?cmd=com.awspaas.user.apps.clue.addSeriesBiz&sid='+sid,
                    method:'post',
                    params:{json:{data:{BO_EU_XSHB_GLYW: params}}}
                }).then(response=>{
                    if(response.data.result == 'ok'){
                        that.GLXSID = that.GLXSID.concat(response.data.data.ID);
                        that.seriesCheckCaseParams['gl.ID']=that.GLXSID.join();
                        callback(response);
                    }else{
                        that.$Message.warning('系统异常，请联系工作站！');
                    }
                }).catch((error)=>{
                    console.log(error);
                });
            },
            //关联案件点击确定增加下方表格
            addAjtab() {
                debugger;
                let idList = this.$refs.seriesCase.getSelectionsId();
                if(idList == undefined || idList.length <= 0){
                    this.$Message.warning('请选择串并案件！');
                }else{
                    this.addSeriesBiz(idList,'02',function(){
                        vm.addAjmodal = false;
                        vm.ajcheckshow = true;
                        setTimeout(() => {
                            vm.$refs['seriesCheckCase'].init();
                        }, 1);
                    });
                }
            },
            addClueTab(){
                let idList = this.$refs.seriesClue.getSelectionsId();
                if(idList == undefined || idList.length <= 0){
                    this.$Message.warning('请选择串并线索！');
                }else{
                    this.addSeriesBiz(idList,'01',function(){
                        vm.addClueModal = false;
                        vm.xscheckshow = true;
                        setTimeout(() => {
                            vm.$refs['seriesCheckClue'].init();
                        }, 1);
                    });
                }

            },
            addGoodsTab(){
                let idList = this.$refs.seriesGoods.getSelectionsId();
                if(idList == undefined || idList.length <= 0){
                    this.$Message.warning('请选择串并物品！');
                }else{
                    this.addSeriesBiz(idList,'03',function(){
                        vm.addGoodsModal = false;
                        vm.wpcheckshow = true;
                        setTimeout(() => {
                            vm.$refs['seriesCheckGoods'].init();
                        }, 1);
                    });
                }

            },
            addPersonTab(){
                let idList = this.$refs.seriesPerson.getSelectionsId();
                if(idList == undefined || idList.length <= 0){
                    this.$Message.warning('请选择串并人员！');
                }else{
                    this.addSeriesBiz(idList,'04',function(){
                        vm.addPersonModal = false;
                        vm.rycheckshow = true;
                        setTimeout(() => {

                            vm.$refs['seriesCheckPerson'].init();
                        }, 1);
                    });
                }

            },
            //删除已关联的线索、案件。。。
            deleteSeriesBiz(cutRow,idField,callback){
                vm.showLoadMask();
                var params = {
                    json:{
                        "data": {
                            "BO_EU_XSHB_GLYW": {
                                "ID": cutRow.ID
                            }
                        }
                    }
                }
                axios({
                    url:'./jd?cmd=com.awspaas.user.apps.clue.deleteSeriesBiz&sid='+sid,
                    methos:'post',
                    params:params
                }).then(response=>{
                    var data = response.data;
                    if(data.result == 'ok') {
                        vm.hideLoadMask();
                        vm.removeByValue(vm.GLXSID, cutRow.ID);
                        for(let i = 0;i<vm.seriesCheckCaseParams.length;i++){
                            if(vm.seriesCheckCaseParams[i].GLYWBH == cutRow[idField] ){
                                vm.seriesCheckCaseParams.splice(i,1);
                            }
                        }
                        callback(response);
                    }else{
                        vm.$Message.warning('系统异常，请联系工作站！');
                    }
                })
            },
            downLoadFile(mc,bh){
                this.showLoadMask();
                var json={
                    "data": {
                        "FJMC": mc,
                        "GLYWBH": bh
                    }
                };
                axios({
                    url: "./jd?",
                    method: "post",
                    params: { sid: sid, json: json, cmd: 'com.awspaas.user.apps.clue.getAttachmentDownloadURL' }
                }).then(response => {
                    if(response.data.result=="ok"){
                        this.hideLoadMask();
                        window.open(response.data.data);
                    }
                }).catch(error => {
                    console.log(error);
                });
            },
            //手动添加物品
            indetifySort(value){
                if(value=='01'){
                    this.goodsSorting = [
                        {value:"01",label:"其他可疑物品"},
                        {value:"02",label:"可疑非机动车"},
                        {value:"03",label:"可疑机动车"},
                        {value:"04",label:"可疑服务标识号"}
                    ]
                }else{
                    this.goodsSorting = [
                        {value:"01",label:"作案工具"},
                        {value:"02",label:"作案移动通讯设备"},
                        {value:"03",label:"作案非机动车"},
                        {value:"04",label:"作案机动车"},
                        {value:"05",label:"作案卡类"},
                        {value:"06",label:"作案枪支"},
                        {value:"07",label:"作案服务标识号"}
                    ]
                }
            },
            isChooseType(){
                let flag = this.handleMove.SAWP;
                if(flag == '') this.$Message.error('未选择涉案物品');
            },
            resetForm(name){
                this.addaj.LADW_GAJGJGDM='';
                for(let key in this[name]){
                    this[name][key] = '';
                    switch (name){
                        case 'addaj':
                            this.$refs.caseDepartment.handleReset();//清空子组件方法input内容
                            this.$refs.caseType.handleReset();
                            break;
                        case 'addGoods':
                            this.$refs.wpType.handleReset();
                            break;
                        case 'addPerson':
                            this.$refs.hjdz.handleReset();
                            break;
                    }
                }
            }
        },
        mounted(){
            for(var key in refillData.rw){
                if(refillData.rw[key] == '') {
                    refillData.rw[key] == '--'
                }
            }
            this.$refs.relevanceEscapee.init();
            this.$refs.relevanceLogistics.init();

            this.uploadList = this.$refs.upload.fileList;
            this.$refs.relevanceClueTable.init();
            this.$refs.relevanceAJTable.init();
            this.$refs.relevanceCBTable.init();
            let jsonn = refillData.rw;
            let fj=refillData.fj;
            this.detailData = jsonn;
            this.dataCount =glxs.total;
            //this.$refs.associatedClues.init();
            if(fj.length == 0){
                this.fjPanel=false;
            }else{
                this.fjPanel=true;
                this.tabs=fj;
            };
            this.jsgt();
            var url = "com.awspaas.user.apps.clue.getUnitOtherUser";
            let _this = this;
            axios({
                url: "./jd?",
                method: "post",
                params: { sid: sid, json: {}, cmd: url }
            }).then(response => {
                var data = response.data.data;
                console.log(data);
                for (let i = 0; i < data.length; i++) {
                    var obj = new Object();
                    obj.label = data[i].USERNAME + "【" + data[i].USERID + "】";
                    obj.value = data[i].USERID;
                    _this.personList.push(obj);
                    var obj2 = new Object();
                    obj2.JSRY_XM = data[i].USERNAME;
                    obj2.JSRY_GMSFHM = data[i].USERID;
                    obj2.JSRY_LXDH = data[i].MOBILE;
                    obj2.JSDW_GAJGMC = data[i].DEPARTMENTNAME;
                    obj2.JSDW_GAJGJGDM = data[i].DEPARTMENTID;
                    _this.zpList.push(obj2);
                }
            }).catch(error => {
                console.log(error);
            });
            this.clickPhoto(this.communicationHead[0].value);
        }
    })
</script>
</body>
</html>
