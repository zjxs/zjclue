<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>线索续报修改</title>
		 <link type="text/css" rel="stylesheet" href="../apps/com.awspaas.user.apps.clue/css/common.css"/>
	     <link type="text/css" rel="stylesheet" href="../apps/com.awspaas.user.apps.clue/css/iview.css"/>
		 <link rel="Bookmark" type="image/x-icon" href="../favicon.ico" />
		 <link rel="icon" type="image/x-icon" href="../favicon.ico" />
		 <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
    </head>
    <style>
        .ivu-form-item-label{
            font-size: 14px!important;
        }
		.ivu-poptip-body-content-inner,.ivu-poptip-inner ,.ivu-poptip-content{
			color:#fff;
			background-color:rgba(70,76,91,.9)
		}
		.ivu-poptip-body-content-inner{
			width:87%
		}
    </style>

	<body class="bkg">
		<div id="app" v-cloak>
			<div id="newclue" class="newclue" style="padding-bottom:85px">
				<Row class="w_bg">
					<i-col span="24">
						<Breadcrumb separator=">">
							<breadcrumb-item>线索管理</breadcrumb-item>
							<breadcrumb-item>修改续报信息</breadcrumb-item>
						</Breadcrumb>
					</i-col>
				</Row>
				<i-form ref="newClue" v-bind:model="newClue" v-bind:rules="clueValidate" v-bind:label-width="120">
                     <!-- id="tiTle" -->
					<Row class="w_bg" id="tiTle">
                        <i-col span="20" class="title_name">
                            <form-item label="标题名称" prop="XSMC" style="margin-bottom:0px;font-size: 14px">
                                <i-input v-model="newClue.XSMC" disabled placeholder="请输入标题名称" class="title_input"></i-input>
                            </form-item>
                        </i-col> 
					</Row> 
					<Row class="w_bg">
						<i-col span="8">
							<form-item label="线索类型" prop="XSLXDM">
								<i-select v-model="newClue.XSLXDM" disabled codeName="CODE_XSHB_XSLX" @on-change="xslxChange">
									<i-option v-for="item in optiondata.zllx" :value="item.value" :key="item.value">{{item.label}}</i-option>
								</i-select>
							</form-item>
						</i-col>
						<i-col span="8">
							<form-item label="线索公开" prop="SFSMDM">
								<i-select v-model="newClue.SFSMDM" disabled codeName>
									<i-option v-for="item in optiondata.sfgk" :value="item.value" :key="item.value">{{item.label}}</i-option>
								</i-select>
							</form-item>
						</i-col>
						<i-col span="8">
							<form-item label="线索级别" prop="XSJBDM">
								<i-select v-model="newClue.XSJBDM" disabled disabled codeName="CODE_XSHB_JB">
									<i-option v-for="item in optiondata.xsjb" :value="item.value" :key="item.value">{{item.label}}</i-option>
								</i-select>
							</form-item>
						</i-col>
						<Poptip word-wrap  placement="bottom" trigger="hover" style="position: absolute;top: 27px;right: 15px;" content="A:限时2小时反馈 B:限时8小时反馈 C:限时24小时反馈 D:限时48小时反馈">
							<Icon type="ios-information-circle-outline" size="20" />
						</Poptip>
						<i-col span="24">
							<form-item label="信息描述" disabled prop="XSMS">
								<i-input type="textarea" v-model="newClue.XSMS" disabled  placeholder="最多输入1000字" :rows="8" :autosize="{minRows: 8,maxRows: 10}" ></i-input>
							</form-item>
						</i-col>
						<i-col span="24" v-if="wlupload">
							<form-item label="物流信息">
								<!-- <Upload ref="wlupload"	 :show-upload-list="false" :max-size="5120"  :on-success="handlewlSuccess" :format="['xlsx','xls']" :on-format-error="handleFormatError" type="drag" action="./uf?appId=com.awspaas.user.apps.clue&sid=<#sid>&groupValue=clue&fileValue=<#UUID>&repositoryName=tmp" class="wlupload">
									<label>
							            <i-button type="primary" style="outline:none">导入Excel</i-button>
							        </label>
							    </Upload>
								<span  @click="confitemp = true" class="confi" v-if="confi">配置模板</span> -->
								<Modal v-model="confitemp" title="配置模板" width="60">
									<i-form ref="temp" v-bind:model="temp" v-bind:rules="tempValidate"  v-bind:label-width="120">
										<Row>
											<i-col span="8">
												<form-item label="物流单号" prop="WLDH">
													<i-select v-model="temp.WLDH"  filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value" @on-click="aaaa()">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="物流公司" prop="WLGS">
													<i-select v-model="temp.WLGS" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收寄物流点" prop="SJWLD">
													<i-select v-model="temp.SJWLD" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="收件人姓名" prop="SJR_XM">
													<i-select v-model="temp.SJR_XM" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收件人电话" prop="SJR_LXDH">
													<i-select v-model="temp.SJR_LXDH" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收件人住址" prop="SJR_XZZ_DZMC">
													<i-select v-model="temp.SJR_XZZ_DZMC" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="物品名称" prop="HW_WPMC">
													<i-select v-model="temp.HW_WPMC" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="买方昵称" prop="MFNC">
													<i-select v-model="temp.MFNC" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="买方身份标识" prop="MFSFBS">
													<i-select v-model="temp.MFSFBS" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="订单时间" prop="DDSJ">
													<i-select v-model="temp.DDSJ" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="送达时间" prop="SDSJ">
													<i-select v-model="temp.SDSJ" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收件时间" prop="SHSJ">
													<i-select v-model="temp.SHSJ" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="寄件人姓名" prop="JJR_XM">
													<i-select v-model="temp.JJR_XM" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="寄件人电话" prop="JJR_LXDH">
													<i-select v-model="temp.JJR_LXDH" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="寄件人住址" prop="JJR_XZZ_DZMC">
													<i-select v-model="temp.JJR_XZZ_DZMC" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="收件人省份" prop="SJR_SF">
													<i-select v-model="temp.SJR_SF" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收件人城市" prop="SJR_CS">
													<i-select v-model="temp.SJR_CS" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="收件人区县" prop="SJR_QX">
													<i-select v-model="temp.SJR_QX" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
										</Row>
										<Row>
											<i-col span="8">
												<form-item label="卖方昵称" prop="MAIFNC">
													<i-select v-model="temp.MAIFNC" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="卖方身份标识" prop="MAIFSFBS">
													<i-select v-model="temp.MAIFSFBS" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
											<i-col span="8">
												<form-item label="计费重量" prop="JFZL">
													<i-select v-model="temp.JFZL" filterable clearable>
														<i-option v-for="item in tempselect.select" :value="item.value" :key="item.value">{{item.label}}</i-option>
													</i-select>
												</form-item>
											</i-col>
							            </Row>
							        </i-form>
							        <div slot="footer">
							            <i-button @click="confitemp=false">取消</i-button>
							            <i-button type="primary" @click="configSubmit('temp')">确定</i-button>
							        </div>
								</Modal>
							</form-item>
                            <sy-table v-if="logisticsTab"
                                ref="logisticsInfo"
                                :url="logisticsInfo.url" 
                                :columns="logisticsInfo.columns" 
                                :query-params="logisticsInfo.params"
                                :pager-page-size="5" 
                                :pager-page-size-opts="[5, 10, 20, 30]" style="width:calc(100% - 60px);margin-left: 60px">
                            </sy-table>
                            
                            
                        </i-col>
                        <i-col span="24" v-if="tfupload">
                            <form-item label="逃犯信息">
                                <i-button type="primary" @click="getEscapee">
                                    <Icon type="ios-add" size="14"></Icon>关联逃犯
                                </i-button>
                                <Modal :closable="false" v-model="addEscapee" width="70%">
                                    <div slot="header" style="height: 35px;line-height: 35px;">
                                        <label>关联逃犯</label>
                                        <div style="float:right;">
                                            <i-button @click="addEscapee=false">取消</i-button>
                                            <i-button type="primary" @click="addToEscapee()">确定</i-button>
                                            <i-button type="success">手动添加</i-button>
                                        </div>
                                    </div>
                                    <i-form ref="escapeeSearch" v-bind:model="escapeeSearch" v-bind:label-width="10">
                                        <row>
                                            <i-col span="5">
                                                <form-item prop="YWSTBH">
                                                    <i-input v-model="escapeeSearch.YWSTBH" placeholder="请输入人员编号或证件号"/>
                                                </form-item>
                                            </i-col>
                                            <i-col span="5">
                                                <form-item prop="ZTRYLXDM">
                                                    <i-select v-model="escapeeSearch.ZTRYLXDM" placeholder="请选择人员角色">
                                                        <i-option value="01">报案人</i-option>
                                                        <i-option value="02">受害人</i-option>
                                                        <i-option value="03">受害单位</i-option>
                                                        <i-option value="04">可疑人</i-option>
                                                        <i-option value="05">嫌疑人</i-option>
                                                        <i-option value="06">已归案嫌疑人</i-option>
                                                        <i-option value="07">未归案嫌疑人</i-option>
                                                    </i-select>
                                                </form-item>
                                            </i-col>
                                            <i-col span="5">
                                                <form-item prop="HJDZ_DZMC">
                                                    <sy-tree tablename="CODE_XZQH" v-model="escapeeSearch.HJDZ_DZMC" @change="escapeeSearch.HJDZ_DZMC=$event"></sy-tree>
                                                </form-item>
                                            </i-col>
                                            <i-col span="5">
                                                <form-item prop="LARQ~11">
                                                   <date-picker type="daterange" style="width:100%;" confirm v-model="escapeeSearch['LARQ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="searchParams['DJSJ~11']=$event"></date-picker>
                                                </form-item>
                                            </i-col>
                                            <i-col span="3" offset="1" style="margin-top: 10px">
                                                <i-button @click="searchEscapee">查询</i-button>
                                            </i-col>
                                        </row>
                                    </i-form>
                                    <sy-table 
                                        ref="EscapeeTab"
                                        id-field="ZTRYBH"
                                        show-selection
                                        :url="EscapeeTab.url"
                                        :columns="EscapeeTab.columns"
                                        :query-params="escapeeSearch"
                                        :pager-page-size="5" 
                                        :pager-page-size-opts="[5, 10, 20, 30]">
                                    </sy-table>
                                    <div slot="footer"></div>
                                </Modal>
                            </form-item>
                            <sy-table 
                                v-if="escapeeCheckTable"
                                ref="relevanceEscapeeTable"
                                :url="relevanceEscapeeTable.url"
                                :columns="relevanceEscapeeTable.columns"
                                :query-params="relevanceEscapeeTable.params"
                                :pager-page-size="5" 
                                :pager-page-size-opts="[5, 10, 20, 30]"
                                @on-selection-change="getSelection"
                                style="width:calc(100% - 60px);margin-left: 60px"
                                >
                            </sy-table>
							<br />
							<br />
                        </i-col>
						<i-col span="24">
							<form-item label="信息附件" style="margin-bottom: 0px">
								<Upload ref="upload" :show-upload-list="false" :default-file-list="defaultList" :on-success="handleSuccess" :on-progress="handlerprogress" :max-size="102400" :on-format-error="handleFormatError" :on-exceeded-size="handleMaxSize" :before-upload="handleBeforeUpload" multiple type="drag" action="./uf?appId=com.awspaas.user.apps.clue&sid=<#sid>&groupValue=clue&fileValue=<#UUID>&repositoryName=sy" style="display: inline-block;width:58px;">
									<div style="width: 58px;height:58px;line-height: 58px;">
										<Icon type="ios-add" size="20"></Icon>
									</div>
								</Upload>
								<div class="demo-upload-list" v-for="(item,index) in uploadList" :key="item.value">
									<div :title="item.name" v-if="matchType(item)==='xlsx'||matchType(item)==='xls'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/excel.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div :title="item.name" v-if="matchType(item) === 'doc'||matchType(item)=== 'docx'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/word.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div :title="item.name" v-if="matchType(item) === 'pptx'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/ppt.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div :title="item.name" v-if="matchType(item) === 'png'||matchType(item) === 'jpg'||matchType(item) === 'jpeg'||matchType(item) === 'gif'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/image.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div :title="item.name" v-if="matchType(item) === 'mp4'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/video.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div :title="item.name" v-if="matchType(item) === 'zip'||matchType(item) === 'rar'||matchType(item) === '7z'">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/zip.png">
										<p>附件{{index + 1}}</p>
									</div>
									<div v-else :title="item.name">
										<Icon type="md-remove-circle" class="up_remove" @click.native="handleRemove(item)" ></Icon>
										<img src="../apps/com.awspaas.user.apps.clue/img/icon/unknown.png">
                                        <p>附件{{index + 1}}</p>
									</div>
								</div>
								<Tooltip content="最多上传15个附件，每个附件最大100M" style="position: absolute;top: 16px;left: -3.5%;">
									<Icon type="ios-information-circle-outline" size="20" />
								</Tooltip>
							</form-item>
						</i-col>
					</Row>
				</i-form>
				<Row style="margin-top: -15px;padding:0px 20px">
					<row class="w_bg">
						<span class="add_conn">添加串并</span>
							<i-button @click="callModal('aj')" class="related_btn">
								<Icon type="ios-add" style="color: #000"></Icon>串并案件
							</i-button>
							<Modal v-model="addAjmodal" title="串并案件" width="70%" @on-ok="addAjtab()" @on-cancel="cancel">
								<Row>
									<i-form ref="addaj" v-model="addaj" v-bind:label-width="30">
										<i-col span="5" label>
											<form-item>
												<i-input v-model="addaj.ASJBH" placeholder="请输入案件编号"></i-input>
											</form-item>
										</i-col>
										<i-col span="5" label>
											<form-item>
												<sy-tree tablename="CODE_GXS_BIZ" v-model="addaj.LADW_GAJGJGDM" @change="addaj.LADW_GAJGJGDM=$event" placeholder="请输入立案单位"></sy-tree>
											</form-item>
										</i-col>
										<i-col span="5" label>
                                            <form-item>
                                                <sy-tree tablename="CODE_AJLB_XL" v-model="addaj.ZATZ_JYQK" @change="addaj.ZATZ_JYQK=$event" placeholder="请输入案件类别"></sy-tree>
                                            </form-item>
										</i-col>
										<i-col span="5" label>
											<form-item>
												<date-picker type="daterange" style="width:100%;" confirm v-model="addaj['LARQ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addaj['LARQ~11']=$event"></date-picker>
											</form-item>
										</i-col>
										<i-col span="4">
											<form-item>
												<i-button @click="searchAllcase()">查询</i-button>
												<i-button @click="resetForm('addaj')">清空</i-button>
											</form-item>
										</i-col>
										</i-form>
								</Row>
                                <sy-table
                                id-field="ASJBH"
                                ref="seriesCase"
                                :url="seriesCase.url" 
                                :columns="seriesCase.columns" 
                                :query-params="seriesCaseParams"
                                :pager-page-size="5" 
                                :pager-page-size-opts="[5, 10, 20, 30]">
                                ></sy-table>  

                            </Modal>
						<i-button @click="callGoodsModal" class="related_btn">
						    <Icon type="ios-add" style="color: #000"></Icon>串并物品
						    <Modal v-model="addGoodsModal" width="70%" footer-hide :closable="false">
						        <div slot="header" style="height: 35px;line-height: 35px;">
						            <label>串并物品</label>
						            <div style="float:right;">
						                <i-button @click="addGoodsModal=false">取消</i-button>
						                <i-button type="primary" @click="addGoodsTab()">确定</i-button>
						                <!-- <i-button type="success" @click="handleMoveModal = true">手动添加</i-button> -->
						            </div>
						        </div>
						        <Row>
						        <!-- 手动添加物品 -->
						        <Modal title="物品分类" v-model="handleMoveModal" width="70%" @on-ok="handAddWp_Ok" @on-cancel="handAddWp_Cancel">
						             <iframe style="border: 0px;" name="handAddWp" v-bind:src="handAddWpSrc" id="handAddWp" scrolling="auto" height="450px" width="100%"></iframe>
						        </Modal>
						        <!-- <i-form ref="handleMove" v-model="handleMove" v-bind:label-width="80">
						                <Row>
						                    <i-col span="24">
						                        <form-item label="涉案物品">
						                            <i-select v-model="handleMove.SAWP" placeholder="请选择涉案物品" @on-change="indetifySort">
						                                <i-option value="01">可疑物品</i-option>
						                                <i-option value="02">作案物品</i-option>
						                            </i-select>
						                        </form-item>
						                    </i-col>
						                    <i-col span="24">
						                        <form-item label="物品分类">
						                            <i-select v-model="handleMove.WPZL" @on-open-change="isChooseType()" placeholder="请选择物品分类">
						                                <i-option v-for="(item,index) in goodsSorting" value="item.value">{{item.label}}</i-option>
						                            </i-select>
						                        </form-item>
						                    </i-col>
						                </Row>
						            </i-form> -->
						        <i-form ref="addGoods" v-model="addGoods" v-bind:label-width="30">
						            <i-col span="5" label>
						                <form-item><i-input v-model="addGoods.SAWPBH" placeholder="请输入物品编号"></i-input></form-item>
						            </i-col>
						            <i-col span="5" label>
						                <form-item>
						                    <sy-tree ref="wpType" tablename="CODE_WPZL" title="请选择物品类别" v-model="addGoods.SAWP_SAWPLB" @change="addGoods.SAWP_SAWPLB=$event" placeholder="请输入物品类别"></sy-tree>
						                </form-item>
						            </i-col>
						            <i-col span="5" label>
						                <form-item> <date-picker type="daterange" style="width:100%;" confirm v-model="addGoods['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addGoods['DJSJ~11']=$event"></date-picker></form-item>
						            </i-col>
						                <i-col span="4">
						                <form-item>
						                    <i-button type="primary" @click="searchAllGoods()">查询</i-button>
						                    <i-button @click="resetForm('addGoods')">清空</i-button>
						                </form-item>
						            </i-col>
						        </i-form> 
						    </Row>
						    <sy-table
						        id-field="SAWPBH"
						        ref="seriesGoods"
						        :url="seriesGoods.url" 
						        :columns="seriesGoods.columns" 
						        :query-params="seriesCaseParams"
						        :pager-page-size="5" 
						        :pager-page-size-opts="[5, 10, 20, 30]">
						    </sy-table>
						    </Modal>
						</i-button>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
						<i-button @click="callPersonModal" class="related_btn">
						    <Icon type="ios-add" style="color: #000"></Icon>串并人员
						    <Modal v-model="addPersonModal" width="70%" footer-hide :closable="false">
						        <div slot="header" style="height: 35px;line-height: 35px;">
						            <label>串并人员</label>
						            <div style="float:right;">
						                <i-button @click="addPersonModal=false">取消</i-button>
						                <i-button type="primary" @click="addPersonTab()">确定</i-button>
						                <!-- <i-button type="success" @click="handAddPersonMoveModal = true">手动添加</i-button> -->
						            </div>
						        </div>
						        <Row>
						        <!-- 手动添加人员 -->
						        <Modal title="新增人员" v-model="handAddPersonMoveModal" width="70%" @on-ok="handAddPerson_Ok" @on-cancel="handAddPerson_Cancel">
						            <iframe style="border: 0px;" name="handAddPerson" v-bind:src="handAddPersonSrc" id="handAddPerson" scrolling="auto" height="450px" width="100%"></iframe>
						        </Modal>
								    <i-form ref="addPerson" v-model="addPerson" v-bind:label-width="30">
						                <i-col span="5" label>
						                    <form-item><i-input v-model="addPerson.ASJXGRYBH" placeholder="请输入人员编号或证件号"></i-input></form-item>
						                </i-col>
						                <i-col span="5" label>
						                    <form-item>
						                        <sy-tree ref="hjdz" tablename="CODE_XZQH" title="请选择户籍地区划" v-model="addPerson.HJDZ_DZMC" @change="addPerson.HJDZ_DZMC=$event" placeholder="请输入户籍地区"></sy-tree>
						                    </form-item>
						                </i-col>
						                <i-col span="5" label>
						                    <form-item>
						                        <date-picker type="daterange" style="width:100%;" confirm v-model="addPerson['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addPerson['DJSJ~11']=$event"></date-picker>
						                    </form-item>
						                </i-col>
						                <i-col span="4">
						                    <form-item>
						                        <i-button type="primary" @click="searchAllPerson()">查询</i-button>
						                        <i-button @click="resetForm('addPerson')">清空</i-button>
						                    </form-item>
						                </i-col>
						            </i-form>
						        </Row>
						        <sy-table
						            id-field="ASJXGRYBH"
						            ref="seriesPerson"
						            :url="seriesPerson.url" 
						            :columns="seriesPerson.columns" 
						            :query-params="seriesCaseParams"
						            :pager-page-size="5" 
						            :pager-page-size-opts="[5, 10, 20, 30]">
						        </sy-table>
						    </Modal>
						</i-button>
							<i-button @click="callClueModal">
                                <Icon type="ios-add" style="color: #000"></Icon>串并线索
                                <Modal v-model="addClueModal" title="串并线索"  width="70%" @on-ok="addClueTab()" @on-cancel="cancel">
								<Row>
									<i-form ref="addClue" v-model="addClue" v-bind:label-width="30">
										<i-col span="5" label>
											<form-item>
												<i-input v-model="addClue.XSBH" placeholder="请输入线索编号"></i-input>
											</form-item>
										</i-col>
										<i-col span="5" label>
											<form-item prop="XSLXDM">
                                                <i-select v-model="addClue.XSLXDM" codeName="CODE_XSHB_XSLX"  placeholder="请输入线索类型">
                                                    <i-option v-for="item in optiondata.zllx" :value="item.value" :key="item.value">{{item.label}}</i-option>
                                                </i-select>
                                            </form-item>
										</i-col>
										<i-col span="5" label>
                                            <form-item prop="XSJBDM">
                                                <i-select v-model="addClue.XSJBDM" codeName="CODE_XSHB_JB" placeholder="请输入线索级别">
                                                    <i-option v-for="item in optiondata.xsjb" :value="item.value" :key="item.value">{{item.label}}</i-option>
                                                </i-select>
                                            </form-item>
										</i-col>
										<i-col span="5" label>
											<form-item>
												<date-picker type="daterange" style="width:100%;" confirm v-model="addClue['DJSJ~11']" format="yyyy-MM-dd" placeholder="开始日期-截止日期"  @on-change="addClue['DJSJ~11']=$event"></date-picker>
											</form-item>
										</i-col>
										<i-col span="4">
											<form-item>
												<i-button @click="searchAllClue()">查询</i-button>
												<i-button @click="resetForm('addClue')">清空</i-button>
											</form-item>
										</i-col>
									</i-form>
								</Row>
                                <sy-table
                                id-field="XSBH"
                                ref="seriesClue"
                                :url="seriesClue.url" 
                                :columns="seriesClue.columns" 
                                :query-params="seriesCaseParams"
                                :pager-page-size="5" 
                                :pager-page-size-opts="[5, 10, 20, 30]">
                                ></sy-table>
                            </Modal> 

							</i-button>
					</row>
				</Row>
				<Row class="each_cb">
					<Row class="w_bg" v-if="ajcheckshow">
						<div class="gl_title">
							<span>串并案件</span>
						</div>
                        <sy-table
                        ref="seriesCheckCase"
                        :url="seriesCheckCase.url" 
                        :columns="seriesCheckCase.columns" 
                        :query-params="seriesCheckCaseParams"
                        :on-load-success="seriesCheckCase.onLoadSuccess"
                        :pager-page-size="5" 
                        :pager-page-size-opts="[5, 10, 20, 30]">
                        ></sy-table>
					</Row>
				</Row>

				<Row class="each_cb">
					<Row class="w_bg" v-if="xscheckshow">
						<div class="gl_title">
							<span>串并线索</span>
						</div>
						<sy-table
                        ref="seriesCheckClue"
                        :url="seriesCheckClue.url" 
                        :columns="seriesCheckClue.columns" 
                        :query-params="seriesCheckCaseParams"
                        :on-load-success="seriesCheckClue.onLoadSuccess"
                        :pager-page-size="5" 
                        :pager-page-size-opts="[5, 10, 20, 30]">
                        ></sy-table>
					</Row>
				</Row>
				<!-- 已经关联的物品 -->
				<Row class="each_cb">
					<Row class="w_bg" v-if="wpcheckshow">
						<div class="gl_title">
							<span>串并物品</span>
						</div>
				        <sy-table
				        id-field="SAWPBH" 
				        ref="seriesCheckGoods"
				        :url="seriesCheckGoods.url" 
				        :columns="seriesCheckGoods.columns" 
				        :query-params="seriesCheckCaseParams"
				        :on-load-success="seriesCheckGoods.onLoadSuccess"
				        :pager-page-size="5" 
				        :pager-page-size-opts="[5, 10, 20, 30]">
				        ></sy-table>
					</Row>
				</Row>
				<!-- 已经关联的人员 -->
				<Row class="each_cb">
					<Row class="w_bg" v-if="rycheckshow">
						<div class="gl_title">
							<span>串并人员</span>
						</div>
						<sy-table
				        ref="seriesCheckPerson"
				        :url="seriesCheckPerson.url" 
				        :columns="seriesCheckPerson.columns" 
				        :query-params="seriesCheckCaseParams"
				        :on-load-success="seriesCheckPerson.onLoadSuccess"
				        :pager-page-size="5" 
				        :pager-page-size-opts="[5, 10, 20, 30]">
				        </sy-table>
					</Row>
				</Row>
				<!-- wpcheckshow -->
				
				<Row class="w_bg fixed_bar" style="position:fixed;width: calc(85% - 15px);">
					<i-button class="pull-right btn" type="primary" @click="submitData('newClue')">继续续报</i-button>
					<i-button class="pull-right btn" @click="formCancel()">取消</i-button>
				</Row>
				<Modal v-model="nextstep" footer-hide width="345" @on-cancel="backToSearchPage()">
					<div class="ivu-modal-confirm-head">
						<div class="ivu-modal-confirm-head-icon ivu-modal-confirm-head-icon-success">
							<i class="ivu-icon ivu-icon-ios-checkmark-circle"></i>
						</div>
						<div class="ivu-modal-confirm-head-title">线索修改成功</div>
					</div>
					<p style="text-indent:3.8em;height:50px;line-height:40px;">你还可以进行如下操作</p>
					<Row>
						<i-col span="6" v-if="userGxsLev != 1" offset="6">
						<i-button type="primary">
							<a :href=report_href style="color:#fff">上报</a>
						</i-button>
						</i-col>
						<i-col v-if="userGxsLev != 3" span="6">
						<i-button>
							<a :href=issue_href>下发</a>
						</i-button>
						</i-col>
					</Row>
                </Modal>
                <Modal v-model="logisticsDetailModal" width="60" title="物流详情" @on-ok="uploadLogistics()">
                    <i-form ref="temp" v-model="temp" v-bind:label-width="120">
                        <Row>
                            <i-col span="8">
                                <form-item label="物流单号" prop="WLDH">
                                    <i-input v-model="temp.WLDH"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="物流公司" prop="WLGS">
                                    <i-input v-model="temp.WLGS"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收寄物流点" prop="SJWLD">
                                    <i-input v-model="temp.SJWLD"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="收件人姓名" prop="SJR_XM">
                                    <i-input v-model="temp.SJR_XM"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收件人电话" prop="SJR_LXDH">
                                    <i-input v-model="temp.SJR_LXDH"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收件人住址" prop="SJR_XZZ_DZMC">
                                    <i-input v-model="temp.SJR_XZZ_DZMC"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="物品名称" prop="HW_WPMC">
                                    <i-input v-model="temp.HW_WPMC"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="买方昵称" prop="MFNC">
                                    <i-input v-model="temp.MFNC"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="买方身份标识" prop="MFSFBS">
                                    <i-input v-model="temp.MFSFBS"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="订单时间" prop="DDSJ">
                        			<date-picker type="datetime" style="width:100%;" confirm v-model="temp.DDSJ" format="yyyy-MM-dd HH:mm:ss"  @on-change="temp['DJSJ']=$event" placeholder="订单时间"></date-picker>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="送达时间" prop="SDSJ">
                                    <date-picker type="datetime" style="width:100%;" confirm v-model="temp.SDSJ" format="yyyy-MM-dd HH:mm:ss" @on-change="temp['SDSJ']=$event" placeholder="送达时间"></date-picker>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收件时间" prop="SHSJ">
                                    <date-picker type="datetime" style="width:100%;" confirm v-model="temp.SHSJ" format="yyyy-MM-dd HH:mm:ss" @on-change="temp['SHSJ']=$event" placeholder="收件时间"></date-picker>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="寄件人姓名" prop="JJR_XM">
                                    <i-input v-model="temp.JJR_XM"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="寄件人电话" prop="JJR_LXDH">
                                    <i-input v-model="temp.JJR_LXDH"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="寄件人住址" prop="JJR_XZZ_DZMC">
                                    <i-input v-model="temp.JJR_XZZ_DZMC"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="收件人省份" prop="SJR_SF">
                                    <i-input v-model="temp.SJR_SF"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收件人城市" prop="SJR_CS">
                                    <i-input v-model="temp.SJR_CS"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="收件人区县" prop="SJR_QX">
                                    <i-input v-model="temp.SJR_QX"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                        <Row>
                            <i-col span="8">
                                <form-item label="卖方昵称" prop="MAIFNC">
                                    <i-input v-model="temp.MAIFNC"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="卖方身份标识" prop="MAIFSFBS">
                                    <i-input v-model="temp.MAIFSFBS"></i-input>
                                </form-item>
                            </i-col>
                            <i-col span="8">
                                <form-item label="计费重量" prop="JFZL">
                                    <i-input v-model="temp.JFZL"></i-input>
                                </form-item>
                            </i-col>
                        </Row>
                    </i-form>
                </Modal>
                
                <Modal v-model="deleteModel" width="360">
					<p slot="header" style="color: #f60; text-align: center;">
						<Icon type="ios-information-circle"></Icon>
						<span>删除提醒</span>
					</p>
					<div style="text-align: center;">
							<h3>确定要删除此信息吗？</h3>
					</div>
					<div slot="footer">
						<i-button size="large" type="error" @click="delDate()" style="width: 100%;">确定</i-button>
					</div>
				</Modal>
            </div>

		</div>
	
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/vue.min.js" ></script>
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/iview.min.js"></script>
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/zh-CN.js"></script>
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/axios.min.js"></script>
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/common.js"></script>
	<script type="text/javascript" src="../apps/com.awspaas.user.apps.clue/js/sy-table.js"></script>
	<script>
		var xbbh = '<#XBBH>';
        var sid = '<#sid>';
        var xs = '<#xs>';
		var rwlzID = '<#rwlzID>';
		var rwlzbh = '<#RWLZBH>';
        var clueIds = '<#clueIds>';
		const user = JSON.parse('<#user>');
        var uuid='<#UUID>';
		var vm=new Vue({
			el: '#app',
			data() {
				//删除modal
	            deleteModel:false,
	            deleteRow:'',
	            deleteRefs:'',
	            deleteXxbh:'',
                const validateRepeat = (rule, value, callback) =>{
                //     var json = vm.$refs.temp.model;
                //     var arr=[];
                //     for(var key in json){
                //         if(json[key]!=''){
                //             arr.push(json[key]);
                //         }
                //     } 
                //     var nary=arr.sort(); //用到了排序
                //     console.log(nary);
                //     for(var i=0;i<arr.length;i++){
                //         if (nary[i]==nary[i+1]){
                //             return callback(new Error('数据不允许重复'));
                //         }
                //         // else{
                //         //     callback();
                //         // }
                //    }
                   callback();
                };
                const validateRepeat2 = (rule, value, callback) =>{
                    // if (!value) {
                    //     return callback(new Error('此项不允许为空'));
                    // }else{
                    //     var json = vm.$refs.temp.model;
                    //     var arr=[];
                    //     for(var key in json){
                    //         if(json[key]!=''){
                    //             arr.push(json[key]);
                    //         }
                    //     }
                    //     var nary=arr.sort(); //用到了排序
                    //     console.log(nary);
                    //     for(var i=0;i<arr.length;i++){
                    //         if (nary[i]==nary[i+1]){
                    //             console.log('no');
                    //             return callback(new Error('数据不允许重复'));
                    //         }
                            
                    //         else{
                    //             console.log('ok');
                    //             callback();
                    //         }
                    //     }
                        callback();
                    // }
                };            
            return {
				//当前用户lev
				userGxsLev : user.userGxsLev,
				//案件详情url
				ajxq_url:'http://10.118.5.30/ajzb/api/ajzb/v1/AjdaManager/ajzbHome?asjbh=',
				//人员详情
				ryxq_url:'http://10.118.5.30/zhyy/sdhc/sdhcSearch.do?zjhm=',
				//物品详情
				wpxq_url:'https://#?ASJBH=',
				//在逃人员详情
				ztxq_url:'http://10.12.221.133/zxyw_zt/ztry/ztryxxzt.do?ztrybh=',
				//在逃人员详细(身份证号)
				ztxq_zjhm_url:'http://10.118.5.30/zhyy/sdhc/sdhcSearch.do?zjhm=',
				defaultList: [],
				visible: false,
                uploadList: [],
                newClue: {
					XSBH:"",
					XSMC: "",
					XSLXDM: "",
					SFSMDM: "",
					XSJBDM: "",
					XSMS: ""
				},
                GLXSID:[],
                GLAJID:[],
                filePath:[],
				optiondata: {
                    zllx: [{value: "01",label: "常规线索"},
                    {value: "02",label: "贩枪线索"},
                    {value: "03",label: "逃犯线索"},
                    ],
                    sfgk: [{value: "01",label: "公开"},
                    {value: "02",label: "私密"}],
					xsjb: [{value: "01",label: "A"},
						{value: "02",label: "B"},
						{value: "03",label: "C"},
						{value: "04",label: "D"}],
					ladw: [{value: "300000",label: "浙江省公安厅【300000】"}],
					jllb: [{value: "dq",label: "盗窃案",
						children: [{value: "rsdq",label: "入室盗窃"},
							{value: "wldq",label: "网络盗窃"}]
					}]
				},
				clueValidate: {
					XSMC: [{
						required: true,
						message: "此项为必填项",
						trigger: "change"
					}],
					XSLXDM: [{
						required: true,
						message: "此项为必填项",
						trigger: "change"
					}],
					SFSMDM: [{
						required: true,
						message: "此项为必填项",
						trigger: "change"
					}],
					XSJBDM: [{
						required: true,
						message: "此项为必填项",
						trigger: "change"
					}],
					XSMS: [{
						required: true,
						message: "此项为必填项",
                        trigger: "change",
                    },
                    { type: 'string', max: 1000, message: '最多输入1000字', trigger: 'change' }]
                },
                cbaj:false,
                cbxs:true,
                seriesCaseParams:{},
                seriesCase:{
                    url:'./jd?cmd=com.awspaas.user.apps.clue.getAllCase&sid='+sid,
                    params:this.seriesCaseParams,
                    columns:[
                        {type: "selection",width: 60,align: "center"},
                        { title: '案件编号',key:'ASJBH',tooltip: true,width:240,
                        	render: (h, params) => {
                        		return h('div', [
                                    h('a',{
                                        attrs: {
                                            href: ''+vm.ajxq_url+params.row.ASJBH+'',
                        					target:'_blank'
                                        }
                                    }, params.row.ASJBH)
                                ]);
                            }	
                        },
                        {title: "案件名称",key: "AJMC",tooltip: "true"},
                        {title: "案件类别",key: "AJLBDM"},
                        {title: "小类案别",key: "ZATZ_JYQK"},
                        {title: "案件发生时间",key: "SLSJ",width:200},
                        {title: "立案日期",key: "LARQ"},
                        {title: "立案单位",key: "LADW_GAJGMC"}
                    ],
                },
                seriesClue:{
                    url:'./jd?cmd=com.awspaas.user.apps.clue.getAreaClue&sid='+sid,
                    params:this.seriesCaseParams,
                    columns:[
                        {type: "selection",width: 60,align: "center"},
                        {title:'线索编号',key:'XSBH',width:240,render:(h,params)=>{
                                let joinStyle = {}, joinText='';
                                if( params.row.GLXSS > 0){
                                    joinStyle = {
                                        color:'#fff',
                                        display:'inline-block',
                                        width: '20px',
                                        height: '20px',
                                        backgroundColor: 'rgba(45, 183, 245, 1)',
                                        marginRight:'5px',
                                        textAlign:'center',
                                        borderRadius: '5px',
                                        lineHeight:'20px'
                                    };
                                    joinText = '串'
                                }else{
                                }
                                return h('div', [
                                    h('span',{
                                        style:joinStyle
                                    },joinText),
                                    h('a',{
                                        attrs: {
                                            href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                            target:'_blank'
                                        }
                                    }, params.row.XSBH)
                                ]);
                            },
                        },
                        {title: "线索名称",key: "XSMC",tooltip: "true"},
                        {title: "线索类型",key: "XSLXDM"},
                        {title: "线索级别",key: "XSJBDM"},
                        {title: "登记时间",key: "DJSJ"},
                        {title: "登记单位",key: "XXDJDW_GAJGMC"},
                    ],
                },
                //已关联案件
                seriesCheckCaseParams:{},
                seriesCheckCase:{
            	url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesCase&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckCase.getData().total;
                    if(total == 0){
                        vm.ajcheckshow = false;
                    }
                },
            	columns:[
            		{ title: '案件编号',key:'ASJBH',tooltip: true,width:200,
            			render: (h, params) => {
            				return h('div', [
            		            h('a',{
            		                attrs: {
            		                    href: ''+vm.ajxq_url+params.row.ASJBH+'',
            							target:'_blank'
            		                }
            		            }, params.row.ASJBH)
            		        ]);
            		    }	
            		},
					{title: "案件名称",key: "AJMC",tooltip: "true"},
					{title: "案件类别",key: "AJLBDM"},
					{title: "小类案别",key: "ZATZ_JYQK"},
					{title: "案件发生时间",key: "SLSJ",width: 200},
					{title: "立案日期",key: "LARQ"},
					{title: "立案单位", key: "LADW_GAJGMC",tooltip:'true'},
					{
						type: "option",
						title: "操作",
						width: 100,
						render: (h, params) => {
							return h("div", [
								h("Icon", {
									props: {
										type: "md-close"
									},
									style: {
										color: "#f00",
										fontSize: "16px",
										fontWeight: "bold",
										cursor: "pointer"
									},
									on: {
										click: () => {
											vm.del(params.row,'ASJBH','seriesCheckCase');
										}
									}
								})
							]);
						}
					}
				],
            },
			seriesPerson:{
			         url:'./jd?cmd=com.awspaas.user.apps.clue.getAllPerson&sid='+sid,
			         params:this.seriesCaseParams,
			         columns:[
			             {type: "selection",width: 60,align: "center"},
			             {title: "人员编号",key: "ASJXGRYBH",tooltip: "true",width:240,},
			             {title: "姓名",key: "XM",tooltip: "true"},
			             {title: "证件号码",key: "CYZJ_ZJHM",
										render: (h, params) => {
											return h('div', [
										        h('a',{
										            attrs: {
										                href: ''+vm.ryxq_url+params.row.CYZJ_ZJHM+'',
														target:'_blank'
										            }
										        }, params.row.CYZJ_ZJHM)
										    ]);
										}
									},
			             // {title: "案件角色",key: ""},
			             {title: "户籍地区",key: "HJDZ_XZQHDM",tooltip:"true"},
			             {title: "登记时间",key: "DJSJ"},
			         ],
			     },
			     seriesGoods:{
			         url:'./jd?cmd=com.awspaas.user.apps.clue.getAllGoods&sid='+sid,
			         params:this.seriesCaseParams,
			         columns:[
			             {type: "selection",width: 60,align: "center"},
			             {title: "物品编号",key: "SAWPBH",tooltip: true,width:240,
			//              	render: (h, params) => {
			//              		return h('div', [
			//                          h('a',{
			//                              attrs: {
			//                                  href: ''+vm.wpxq_url+params.row.SAWPBH+'',
														// target:'_blank'
			//                              }
			//                          }, params.row.SAWPBH)
			//                      ]);
			//                  }	
			             },
			             {title: "物品名称",key: "WPMC",tooltip: "true"},
			             {title: "涉案物品",key: ""},
			             {title: "物品类别",key: "SAWP_SAWPDM",tooltip:"true"},
			             {title: "登记时间",key: "DJSJ"},
			             {title: "登记单位",key:"XXDJDW_GAJGMC"},
			             {title: "特征描述",key:"WPTZMS",tooltip:"true"},
			         ],
			     },
            seriesCheckClue:{
                url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesClue&sid='+sid,
                params:this.seriesCheckCaseParams,
                onLoadSuccess: function(){
                    let total = vm.$refs.seriesCheckClue.getData().total;
                    if(total == 0){
                        vm.xscheckshow = false;
                    }
                },
            	columns:[
                        { title: '线索编号',key:'XSBH',tooltip: true,
                        	render: (h, params) => {
                        		return h('div', [
                                    h('a',{
                                        attrs: {
                                            href: './w?cmd=com.awspaas.user.apps.clue.router&classify=clue&action=detail&sid='+sid+'&extendParams={"XSBH":"'+params.row.XSBH+'"}',
                                        }
                                    }, params.row.XSBH)
                                ]);
                            }	
                        },
						{title: "线索名称",key: "XSMC",tooltip: "true"},
						{title: "线索类型",key: "XSLXDM"},
						{title: "登记时间",key: "DJSJ"},
						{title: "线索描述",key: "XSMS",tooltip: "true"},
						{
							type: "option",
							title: "操作",
							width: 100,
							render: (h, params) => {
								return h("div", [
									h("Icon", {
										props: {
											type: "md-close"
										},
										style: {
											color: "#f00",
											fontSize: "16px",
											fontWeight: "bold",
											cursor: "pointer"
										},
										on: {
											click: () => {
												vm.del(params.row,'XSBH','seriesCheckClue');
											}
										}
									})
								]);
							}
						}
					]
            },
			seriesCheckPerson:{
			    url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesPerson&sid='+sid,
			    params:this.seriesCheckCaseParams,
			    onLoadSuccess: function(){
			        let total = vm.$refs.seriesCheckPerson.getData().total;
			        if(total == 0){
			            vm.rycheckshow = false;
			        }
			    },
				columns:[
			        {title: "人员编号",key: "ASJXGRYBH"},
			        {title: "证件号码",key: "CYZJ_ZJHM",
						render: (h, params) => {
							return h('div', [
						        h('a',{
						            attrs: {
						                href: ''+vm.ryxq_url+params.row.CYZJ_ZJHM+'',
										target:'_blank'
						            }
						        }, params.row.CYZJ_ZJHM)
						    ]);
						}
					},
			        {title: "姓名",key: "XM"},
			        {title: "登记时间",key: "DJSJ"},
			        {title: "户籍地址",key: "HJDZ_XZQHDM",tooltip: "true"},
			        {
			            type: "option",
			            title: "操作",
			            width: 100,
			            render: (h, params) => {
			                return h("div", [
			                    h("Icon", {
			                        props: {
			                            type: "md-close"
			                        },
			                        style: {
			                            color: "#f00",
			                            fontSize: "16px",
			                            fontWeight: "bold",
			                            cursor: "pointer"
			                        },
			                        on: {
			                            click: () => {
			                            	vm.del(params.row,'ASJXGRYBH','seriesCheckPerson');
			                            }
			                        }
			                    })
			                ]);
			            }
			        }
			    ]
			},
			seriesCheckGoods:{
			    url:'./jd?cmd=com.awspaas.user.apps.clue.getSeriesGoods&sid='+sid,
			    params:this.seriesCheckCaseParams,
			    onLoadSuccess: function(){
			        let total = vm.$refs.seriesCheckGoods.getData().total;
			        if(total == 0){
			            vm.wpcheckshow = false;
			        }
			    },
				columns:[
			        {title: "物品编号",key: "SAWPBH",width: 240},
			        {title: "物品名称",key: "WPMC",tooltip: "true"},
			        {title: "物品类别",key: "SAWP_SAWPDM",tooltip:"true"},
			        {title: "登记时间",key: "DJSJ"},
			        {title: "登记单位",key:"XXDJDW_GAJGMC"},
			        {title: "特征描述",key:"WPTZMS",tooltip:"true"},
			        {
			            type: "option",
			            title: "操作",
			            width: 100,
			            render: (h, params) => {
			                return h("div", [
			                    h("Icon", {
			                        props: {
			                            type: "md-close"
			                        },
			                        style: {
			                            color: "#f00",
			                            fontSize: "16px",
			                            fontWeight: "bold",
			                            cursor: "pointer"
			                        },
			                        on: {
			                            click: () => {
			                            	vm.del(params.row,'SAWPBH','seriesCheckGoods');
			                            }
			                        }
			                    })
			                ]);
			            }
			        }
			    ]
			},

				addAjmodal: false,
				addaj: {
					ASJBH: "",
					LADW_GAJGJGDM: "",
                    ZATZ_JYQK: "",
                    "LARQ~11":""
                },
                addClue:{
                    XSBH: "",
					XSJBDM: "",
                    XSLXDM: "",
                    "DJSJ~11":""
                },
				addPerson:{
				    ASJXGRYBH:"",
				    HJDZ_DZMC:"",
				    "DJSJ~11": ""
				},
				addGoods:{
				    SAWPBH:"",
				    SAWP_SAWPLB:"",
				    "DJSJ~11": ""
				},
				addClueModal:false, 
				addGoodsModal:false,
				addPersonModal:false,
				addEscapee: false,
				showHeader: false,
				//选中后的下方串并表格的显示隐藏
				ajcheckshow: false,
				xscheckshow:false,
				rycheckshow: false,
				wpcheckshow:false,
				wlupload: false, //贩枪线索物流信息是否显示
				tfupload:false,//逃犯线索逃犯信息是否显示
				confitemp: false, //配置模板弹框
				//配置模板Excel数据文件导入
				temp: {
					WLDH: "",
					WLGS: "",
					SJWLD: "",
					SJR_XM: "",
					SJR_LXDH: "",
					SJR_XZZ_DZMC: "",
					HW_WPMC: "",
					MFNC: "",
					MFSFBS: "",
					DDSJ: "",
					SDSJ: "",
					SHSJ: "",
					JJR_XM: "",
					JJR_LXDH: "",
					JJR_XZZ_DZMC: "",
					SJR_SF: "",
					SJR_CS: "",
					SJR_QX: "",
					MAIFNC: "",
					MAIFSFBS: "",
					JFZL: "",
                },
                tempselect:{
                    select: []
                },
				tempValidate: {
                    WLDH: [{required: true, validator: validateRepeat2,trigger:'change'}],          
                    WLGS: [{validator: validateRepeat, trigger: 'change' }],  
                    SJWLD: [{required: true,validator: validateRepeat2, trigger: 'change' }],
                    SJR_XM: [{required: true,validator: validateRepeat2, trigger: 'change' }],
                    SJR_LXDH: [{required: true,validator: validateRepeat2, trigger: 'change' }],
					SJR_XZZ_DZMC:[{required: true,validator: validateRepeat2, trigger: 'change' }],
					HW_WPMC: [{required: true,validator: validateRepeat2, trigger: 'change' }],
					MFNC: [{ validator: validateRepeat, trigger: 'change' }],
					MFSFBS:[{ validator: validateRepeat, trigger: 'change' }],
					DDSJ: [{ required: true,validator: validateRepeat2, trigger: 'change' }],
					SDSJ: [{ validator: validateRepeat, trigger: 'change' }],
					SHSJ: [{ validator: validateRepeat, trigger: 'change' }],
					JJR_XM: [{ validator: validateRepeat, trigger: 'change' }],
					JJR_LXDH: [{ validator: validateRepeat, trigger: 'change' }],
					JJR_XZZ_DZMC: [{ validator: validateRepeat, trigger: 'change' }],
					SJR_SF: [{ required: true,validator: validateRepeat2, trigger: 'change' }],
					SJR_CS:[{required: true,validator: validateRepeat2, trigger: 'change' }],
					SJR_QX: [{ required: true,validator: validateRepeat2, trigger: 'change' }],
					MAIFNC: [{ validator: validateRepeat, trigger: 'change' }],
					MAIFSFBS: [{ validator: validateRepeat, trigger: 'change' }],
					JFZL: [{ validator: validateRepeat, trigger: 'change' }],
                },
                
				nextstep: false, //点击下方固定bar的确定按钮调用的弹框
				//表格分页相关
				pagenum: 1,
				total: 0,
				pageSize: 5,
				xia: '',
				btn_name: '',
				//线索保存成功之后返回的编号
				report_href: '',
                issue_href: '',
                //线索表格的选中项
                xsselection:[],
                //案件表格的选中项
                ajselection:[],
                //配置模板的按钮的显示隐藏
                confi:false,
                //物流信息表
                logisticsDetailModal:false,//已关联的物流信息表的编辑弹框
                logisticsInfo:{
                    url:'./jd?cmd=com.awspaas.user.apps.clue.getClueRelevanceLogistics&sid='+sid,
                    params:{
                        "XSBH":JSON.parse(this.getUrlKey("extendParams")).XSBH
                    },
                    columns:[
                        {title: "物品名称",key: "HW_WPMC"},
                        {title: "物流单号",key: "WLDH"},
                        {title: "收件人",key: "SJR_XM"},
                        {title: "联系方式",key: "SJR_LXDH"},
                        {title: "收件时间",key: "SHSJ"},
                        {title: "收件地区",key: "SJR_XZZ_DZMC"},
                        {
							type: "option",
							title: "操作",
							width: 100,
							render: (h, params) => {
								return h("div", [
                                    h("icon",{
                                        props:{
                                            type:'ios-create-outline'
                                        },
                                        style: {
											color: "#2d8cf0",
											fontSize: "16px",
											fontWeight: "bold",
                                            cursor: "pointer",
                                            marginRight:'5px'
                                        },
                                        on:{
                                            click:() =>{
                                                vm.logisticsDetailModal = true;
                                                for(var key in vm.temp){
                                                    vm.temp[key] = params.row[key];
                                                }
                                                sessionStorage.setItem('uploadId',params.row.ID);
                                            }
                                        }
                                    }),
// 									h("Icon", {
// 										props: {
// 											type: "md-close"
// 										},
// 										style: {
// 											color: "#f00",
// 											fontSize: "16px",
// 											fontWeight: "bold",
// 											cursor: "pointer"
// 										},
// 										on: {
// 											click: () => {
// 												var json = {
// 													"data": {
// 														"BO_EU_XSHB_GLYW": {
// 															"ID": params.row.ID
// 														}
// 													}
// 												}
//                                                 //删除关联物流数据
//                                                 var json = {
//                                                     "json":{
//                                                         "data": {
//                                                             "BO_EU_XSHB_GLWL": {
//                                                                 "ID": params.row.ID,
//                                                             }
//                                                         }
//                                                     }
//                                                 }
//                                                 axios({
//                                                     url:'./jd?cmd=com.awspaas.user.apps.clue.deleteRelevanceLogistics&sid='+sid,
//                                                     method: 'post',
//                                                     params:json,
//                                                 }).then(response=>{
//                                                     var data=response.data.data;
//                                                     if(data.result == 'ok'){
//                                                         _this.$refs['relevanceEscapeeTable'].init();
//                                                     }
//                                                 }).catch((error)=>{
//                                                     console.log(error);
//                                                 });
// 											}
// 										}
//                                     }),
								]);
							}
						}
                    ]
                },
                logisticsTab:false,
                escapeeSearch:{
                    YWSTBH:"",ZTRYLXDM:"",
                    HJDZ_DZMC:"","LARQ~11":""
                },
                EscapeeTab:{
                    url:'./jd?cmd=com.awspaas.user.apps.clue.getAllEscapee&sid='+sid,
                    params:this.escapeeSearch,
                     columns:[
                        {title: "在逃编号",key: "ZTRYBH"},
                        {title: "姓名",key: "XM"},
                        {title: "证件号码",key: "ZJHM"},
                        {title: "立逃单位",key: "XXDJDW_GAJGMC"},
                        {title: "立逃时间",key: "DJSJ"} 
                     ]
                },
                escapeeCheck:[],//在所有表中的选中的人员
                //选中的逃犯表格
                escapeeCheckTable :false, //下方表格的现实隐藏
                relevanceEscapeeTable:{
                    url:'./jd?cmd=com.awspaas.user.apps.clue.getClueRelevanceEscapee&sid='+sid,
                    params:{'XSBH' : JSON.parse(this.getUrlKey("extendParams")).XSBH},
                    columns:[
                        {title: "在逃编号",key: "ZTRYBH",}, 
                        {title: "姓名",key: "XM"},
                        {title: "证件号码",key: "ZJHM",},
                        {title: "户籍地址",key: "HJDZ_DZMC"},
                        {title: "立逃单位",key: "XXDJDW_GAJGMC"},
                        {title: "立逃时间",key: "DJSJ",tooltip: "true"},
                        {
							type: "option",
							title: "操作",
							width: 100,
							render: (h, params) => {
								return h("div", [
									h("Icon", {
										props: {
											type: "md-close"
										},
										style: {
											color: "#f00",
											fontSize: "16px",
											fontWeight: "bold",
											cursor: "pointer"
										},
										on: {
											click: () => {
                                                //删除关联逃犯数据
                                                var json = {
                                                    "json":{
                                                        "data": {
                                                            "BO_EU_XSHB_GLTF": {
                                                                "ZTRYBH": params.row.ZTRYBH,
                                                            }
                                                        }
                                                    }
                                                }
                                                axios({
                                                    url:'./jd?cmd=com.awspaas.user.apps.clue.deleteRelevanceEscapee&sid='+sid,
                                                    method: 'post',
                                                    params:json,
                                                }).then(response=>{
                                                    var data=response.data;
                                                    if(data.result == 'ok'){
                                                        vm.TFID.splice(vm.TFID.indexOf(params.row.ID), 1);
                                                        setTimeout(function(){
                                                            vm.$refs['relevanceEscapeeTable'].init();
                                                        }, 1); 
                                                        vm.$Message.success(data.msg);
                                                        vm.hideLoadMask();
                                                    }
                                                }).catch((error)=>{
                                                    console.log(error);
                                                });
											}
										}
									})
								]);
							}
						}
                    ]
                },
				 FQPCH:'',//贩枪号
				  TFID:[],//逃犯ID
				  enclosureUpload:true,//上传附件的uoload钮
				  handleMove:{
				      WPZL:"",SAWP:""
				  },
				  handleMoveModal:false,
				  handAddPersonMoveModal:false,
				  handAddEscapeeMoveModal:false,
				  goodsSorting:[],
				  handAddPersonSrc:"http://41.188.66.51/api/ajzb/v1/formModel?pageName=zaxxydtxsblr&viewId=INSERT_VIEW&tableName=TB_XW_ZASYYDTXSB&fk=ASJBH&fkValue=A1301053506002018030010&rnd=1553480185405",
				  handAddWpSrc:"http://17.23.8.190:7063/api/ajzb/v1/formModel?pageName=kyxxkyrylrtoxx&viewId=INSERT_VIEW&tableName=TB_XW_WFFZKYRY&fk=ASJBH&fkValue=",
				  handAddEscapeeSrc:"http://17.23.8.190:7063/api/ajzb/v1/formModel?pageName=kyxxkyrylrtoxx&viewId=INSERT_VIEW&tableName=TB_XW_WFFZKYRY&fk=ASJBH&fkValue="
              }
			},
			methods: {
				del(row,xxbh,refs){
            		this.deleteRow=row,
            		this.deleteRefs=refs,
            		this.deleteXxbh=xxbh,
					this.deleteModel = true;
				},
				
				delDate(){
					vm.deleteSeriesBiz(vm.deleteRow,vm.deleteXxbh,function(response){
                        setTimeout(() => {
                        	vm.$refs[vm.deleteRefs].init();
                            vm.$Message.info("删除成功");
                            vm.deleteModel = false;
                        }, 1);
                    });
				},
					/* 获取URL参数 */
					getUrlKey(name){
						 return decodeURIComponent((new RegExp('[?|&]'+name+'='+'([^&;]+?)(&|#|;|$)').exec(location.href)||[,""])[1].replace(/\+/g,'%20'))||null;
					},
					/* 手动添加人员 */
					handAddPerson_Ok () {
						var json = this.getIframeData("handAddPerson");
				        axios({
				            url: "./jd?",
				            method: "post",
				            params: { 
				            	sid: sid, 
				            	json: json,
				            	cmd: "com.awspaas.user.apps.clue.handAdd" 
				            	}
				        }).then(response => {
				        	this.$Modal.success({
				                title: response.data.msg,
				                onOk: () => {
				                    this.$refs['seriesPerson'].init();
				                }
				            });
				        }).catch(error => {
				        	this.$Modal.error({
				                title: response.data.msg,
				            });
				        });
				    },
				    handAddPerson_Cancel () {
				        
				    },
				    
				    /* 手动添加物品 */
				    handAddWp_Ok () {
						var json = this.getIframeData("handAddWp");
				        axios({
				            url: "./jd?",
				            method: "post",
				            params: { 
				            	sid: sid, 
				            	json: json,
				            	cmd: "com.awspaas.user.apps.clue.handAdd" 
				            	}
				        }).then(response => {
				        	this.$Modal.success({
				                title: response.data.msg,
				                onOk: () => {
				                    this.$refs['seriesGoods'].init();
				                }
				            });
				        }).catch(error => {
				        	this.$Modal.error({
				                title: response.data.msg,
				            });
				        });
				    },
				    handAddWp_Cancel () {
				        
				    },
				    
				    /* 手动录入逃犯 */
				    handAddEscapee_Ok () {
						var json = this.getIframeData("handAddEscapee");
				        axios({
				            url: "./jd?",
				            method: "post",
				            params: { 
				            	sid: sid, 
				            	json: json,
				            	cmd: "com.awspaas.user.apps.clue.handAdd" 
				            	}
				        }).then(response => {
				        	this.$Modal.success({
				                title: response.data.msg,
				                onOk: () => {
				                    this.$refs['EscapeeTab'].init();
				                }
				            });
				        }).catch(error => {
				        	this.$Modal.error({
				                title: response.data.msg,
				            });
				        });
				    },
				    handAddEscapee_Cancel () {
				        
				    },
				searchData(json, url, callback) {
					let param = new URLSearchParams();
					param.append("json",JSON.stringify(json));
					axios({
						 url: "./jd?sid="+sid+"&cmd="+url,
						method: "post",
						data: param
					}).then(response => {
						callback(response);
					}).catch(error => {
						console.log(error);
					});
				},
				removeByValue(arr, val) {
					for(var i = 0; i < arr.length; i++) {
						if(arr[i] == val) {
							arr.splice(i, 1);
							break;
						}
					}
				},
				showLoadMask() {
					this.$Spin.show({
						render: (h) => {
							return h('div', [
								h('Icon', {
									'class': 'demo-spin-icon-load',
									props: {
										type: 'ios-loading',
										size: 18
									}
								}),
								h('div', '加载中')
							])
						}
					});
				},
				hideLoadMask() {
					setTimeout(() => {
						this.$Spin.hide();
					}, 100);
				},
				//取消方法
				formCancel(){
					this.$Modal.confirm({
						title: '取消修改线索',
						//content: '<p>Content of dialog</p><p>Content of dialog</p>',
						onOk: () => {
							window.location.href='./w?cmd=com.awspaas.user.apps.clue.router&sid='+sid+'&classify=clue&action=search'; 
						},
						onCancel: () => {
							//this.$Message.info('Clicked cancel');
						}
					});
					
				},
				//提交
				submitData(name) {
					debugger;
					var _this = this;
					this.$refs[name].validate(valid => {
						if(valid) {
							this.showLoadMask();
							debugger;
							var json = this.newClue;
							var newjson = new Object();
							for(var key in json) {
								if(json[key] != "" && json[key] != undefined) {
									newjson[key] = json[key];
								}
							}
							
							var transdata = {
								data: {
									BO_EU_XSHB_XS: newjson,
									BO_EU_XSHB_GLYW: {
										"ID": _this.GLXSID.join()
									},
									BO_EU_XSHB_FJ: {
										FJLJ:this.filePath.join()
									},
									BO_EU_XSHB_RW_LZ: {
										ID:'<#rwlzID>',
										RWLZBH:'<#RWLZBH>'
									},
									XBBH:xbbh,
									taskInstId:'<#taskInstId>',
									processInstId:'<#processInstId>'

								}
							};
							console.log("传过来的json"+newjson);
							let param = new URLSearchParams();
							param.append("json",JSON.stringify(transdata));
							axios({
									url: "./jd?sid="+sid+"&cmd=com.awspaas.user.apps.clue.updateResubmit",
									method: "post",
									data: param
								}).then(response => {
									if(response.data.result=='ok'){
										_this.hideLoadMask();
										vm.$Modal.success({
										    title: response.data.msg,
										    content: '点击确定后返回查询页面',
										    onOk: () => {
										    	window.location.href='./w?cmd=com.awspaas.user.apps.clue.router&sid=<#sid>&classify=report&action=search';
										    }
										}); 
									}
								})
								.catch(error => {
									console.log(error);
								});
						} else {
							this.$Message.error("请填写必填内容!");
						}
					});
				},
				valiName() {},
				addSeriesBiz(idList,ywlxdm,callback){
				    let that = this;
				    let params = [];
				    idList.forEach((item) => {
				        params.push({
				            GLYWBH : item,
				            GLYWLXDM : ywlxdm
				        });
				    });
				    axios({
				        url:'./jd?cmd=com.awspaas.user.apps.clue.addSeriesBiz&sid='+sid,
				        method:'post',
				        params:{json:{data:{BO_EU_XSHB_GLYW: params}}}
				    }).then(response=>{
				        if(response.data.result == 'ok'){
				            that.GLXSID = that.GLXSID.concat(response.data.data.ID);
				            that.seriesCheckCaseParams['gl.ID']=that.GLXSID.join();
				            callback(response);                            
				        }else{
				            that.$Message.warning('系统异常，请联系工作站！');
				        }
				    }).catch((error)=>{
				        console.log(error);
				    });
				},
				//串并案件点击确定增加下方表格
				addAjtab() {
				    let idList = this.$refs.seriesCase.getSelectionsId();
				    this.addSeriesBiz(idList,'02',function(){
				        vm.addAjmodal = false; 
				        vm.ajcheckshow = true;
				        setTimeout(() => {
				            vm.$refs['seriesCheckCase'].init();
				        }, 1);
				    });
				},
				addClueTab(){
				    let idList = this.$refs.seriesClue.getSelectionsId();
				    this.addSeriesBiz(idList,'01',function(){
				        vm.addClueModal = false;
				        vm.xscheckshow = true;
				        setTimeout(() => {
				            vm.$refs['seriesCheckClue'].init();
				        }, 1);
				    });
				},
				addGoodsTab(){
				    let idList = this.$refs.seriesGoods.getSelectionsId();
				    this.addSeriesBiz(idList,'03',function(){
				        vm.addGoodsModal = false;
				        vm.wpcheckshow = true;
				        setTimeout(() => {
				            vm.$refs['seriesCheckGoods'].init();
				        }, 1);
				    });
				},
				addPersonTab(){
				    let idList = this.$refs.seriesPerson.getSelectionsId();
				    this.addSeriesBiz(idList,'04',function(){
				        vm.addPersonModal = false;
				        vm.rycheckshow = true;
				        setTimeout(() => {
				        	
				            vm.$refs['seriesCheckPerson'].init();
				        }, 1);
				    });
				},
				//添加串并案件串并
				callModal(name) {
                    this.addaj.ASJBH='',
                    this.addaj.LADW_GAJGJGDM='',
                    this.addaj['LARQ~2']='',
                    this.addaj['LARQ~3']='',

					this.btn_name = name;
					var _this = this;
					_this.addAjmodal = true;
					if(name == 'aj') {
						this.seriesCaseParams = {
                            ID: _this.GLXSID.join()
                        };
                        setTimeout(() => { _this.$refs['seriesCase'].init(); }, 1);
					} else {
                        // this.seriesCaseParams = {
                        //     'ID~10': _this.GLXSID.join()
                        // };
                        // setTimeout(() => { _this.$refs['seriesClue'].init(); }, 1);
					}
				},
				callwpModal() {
					this.addwpmodal = true;
				},
				callGoodsModal(){
				    this.addGoodsModal = true;
				    for(var key in this.addGoods){
				        this.addGoods[key]='';
				    }
				    this.seriesCaseParams = {
				        'ID': this.GLXSID.join()
				    };
				    setTimeout(() => {
				        this.$refs['seriesGoods'].init();
				    }, 1);
				},
				callPersonModal(){
				    this.addPersonModal = true;
				    for(var key in this.addPerson){
				        this.addPerson[key]='';
				    }
				    this.seriesCaseParams = {
				        'ID': this.GLXSID.join()
				    };
				    setTimeout(() => {
				        this.$refs['seriesPerson'].init();
				    }, 1);
				},
				ok() {},
				cancel() {},
				matchType(item) {
					return item.name.substring(
					  item.name.lastIndexOf(".") + 1,
					  item.name.length
					);
				},
				//上传附件
				handleRemove(file) {
					const fileList = this.$refs.upload.fileList;
                    this.$refs.upload.fileList.splice(fileList.indexOf(file), 1);
                    this.filePath.splice(fileList.indexOf(file), 1);
				},
				handleSuccess(res, file, fileList) {
                    let msg = res.data.msg;
                    let filePath = typeof msg == 'string' ? JSON.parse(res.data.msg).filePath : res.data.msg.filePath;
                    this.filePath.push(filePath);
					this.hideLoadMask();
				},
				handlerprogress(event, file, fileList){
					this.showLoadMask();
				},
				handleFormatError(file) {
					this.$Notice.warning({
						title: "错误的文件格式",
						desc: "文件 " +
							file.name +
							" 格式不正确"
					});
				},
				handleMaxSize(file) {
					this.$Notice.warning({
						title: "文件内容过大",
						desc: "文件  " + file.name + "超出100M."
					});
				},
				handleBeforeUpload() {
					const check = this.uploadList.length < 15;
					if(!check) {
						this.$Notice.warning({
							title: "最多上传15个附件！"
						});
					}
					return check;
				},
				//串并案件表格选中项
				handleChange(selection) {
					if(this.btn_name == 'aj') {
						this.ajselection = selection;
					} else {
						this.xsselection = selection;
					}
                },
                addSeriesBiz(idList,ywlxdm,callback){
                    let that = this;
                    let params = [];
                    idList.forEach((item) => {
                        params.push({
                            GLYWBH : item,
                            GLYWLXDM : ywlxdm
                        });
                    });
                    axios({
                        url:'./jd?cmd=com.awspaas.user.apps.clue.addSeriesBiz&sid='+sid,
                        method:'post',
                        params:{json:{data:{BO_EU_XSHB_GLYW: params}}}
                    }).then(response=>{
                        if(response.data.result == 'ok'){
                            console.log(response.data.data.ID)
                            that.GLXSID = that.GLXSID.concat(response.data.data.ID);
                            console.log(that.GLXSID)
                            that.seriesCheckCaseParams['gl.ID']=that.GLXSID.join();
                            callback(response);                            
                        }else{
                            that.$Message.warning('系统异常，请联系工作站！');
                        }
                    }).catch((error)=>{
                        console.log(error);
                    });
                },
				//串并案件点击确定增加下方表格
				addAjtab() {
                    let idList = this.$refs.seriesCase.getSelectionsId();
                    this.addSeriesBiz(idList,'02',function(){
                        vm.ajcheckshow = true;
                        setTimeout(() => {
                            vm.$refs['seriesCheckCase'].init();
                        }, 1);
                    });
                },
                addClueTab(){
                    let idList = this.$refs.seriesClue.getSelectionsId();
                    this.addSeriesBiz(idList,'01',function(){
                        vm.xscheckshow = true;
                        setTimeout(() => {
                            vm.$refs['seriesCheckClue'].init();
                        }, 1);
                    });
                },
				//串并线索弹框
				callClueModal() {
                    this.addClueModal = true;
                    for(var key in this.addClue){
                        this.addClue[key]='';
                    }
                    this.seriesCaseParams = {
                        'ID~10': this.GLXSID.join()
                    };
                    setTimeout(() => {
                        this.$refs['seriesClue'].init();
                    }, 1);
				},
				handAdd() {
					this.handaddm = true;
                },
                //删除已关联的线索、案件。。。
                deleteSeriesBiz(cutRow,idField,callback){
                    vm.showLoadMask();
                    var params = {
                        json:{
                            "data": {
                                "BO_EU_XSHB_GLYW": {
                                    "ID": cutRow.ID
                                }
                            }
                        }
                    }
                    axios({
                        url:'./jd?cmd=com.awspaas.user.apps.clue.deleteSeriesBiz&sid='+sid,
                        methos:'post',
                        params:params
                    }).then(response=>{
                        var data = response.data;
                        if(data.result == 'ok') {
                            vm.hideLoadMask();
                            vm.removeByValue(vm.GLXSID, cutRow.ID);
                            for(let i = 0;i<vm.seriesCheckCaseParams.length;i++){
                                if(vm.seriesCheckCaseParams[i].GLYWBH == cutRow[idField] ){
                                    vm.seriesCheckCaseParams.splice(i,1);
                                }
                            }
                            callback(response);
                        }else{
                            vm.$Message.warning('系统异常，请联系工作站！');
                        }
                    })
                },
                //改变线索类型时（贩枪线索）
				xslxChange(value) {
					if(value == "02") {
                        this.wlupload = true;
                        this.tfupload = false;
					} else if(value == '03'){
                        this.wlupload = false;
                        this.tfupload = true;
					}else{
                        this.wlupload = false;
                        this.tfupload = false;
                    }
				},
				//物流Excel表上传
				handlewlSuccess(res) {
                    let msg = typeof res.data.msg == 'string' ? JSON.parse(res.data.msg) : res.data.msg;
                    
                    this.tempselect.select= msg.columnsTitle;
                    this.$Message.success('上传成功');
                    this.confi = true;
                    sessionStorage.setItem('filePath',msg.filePath);
				},
				//配置模板弹框
				callTemplate() {
					this.confitemp = true;
				},
				//配置弹框里面的提交按钮方法
				configSubmit(name) {
                    var _this = this;
					this.$refs[name].validate((valid) => {
						if(valid) {
                            var json = this.$refs.temp.model;
                            var newjson={};
                            for(var key in json){
                                if(json[key] != ''){
                                    newjson[json[key]]=key;
                                }
                            }
                            var url = "com.awspaas.user.apps.clue.importRelevanceLogistics";
                            var filePath = sessionStorage.getItem('filePath');
                            var transdata = {
                                "contrastMap":newjson,
                                "uuid":uuid,
                                "filePath":filePath
                            };
							this.searchData(transdata, url, function(response) {
                                var data = response.data;
                                if(data.result == 'ok') {
                                    _this.FQPCH=data.data.PCH;
                                    _this.confitemp=false;
                                    _this.logisticsTab=true;
                                    _this.logisticsInfo.params.PCH = data.data.PCH;
                                    setTimeout(function(){
                                        _this.$refs['logisticsInfo'].init();
                                    }, 1);    
									this.$refs.temp.resetFields();
								}
                            })
							this.$Loading.start();
						} else {
							this.$Message.error("请填写必填内容!");
						}
					});
                },
				changeData(data) {
					this.addaj.LADW_GAJGJGDM = data;
				},
// 				searchAllcase() {
//                     var json = this.addaj;
//                     for(var key in json) {
//                         if(json[key] == '') {
//                             delete json[key];
//                         }
//                     }
//                     json.ID = this.GLXSID.join();
//                     this.seriesCaseParams = json;
//                     setTimeout(() => { this.$refs['seriesCase'].init(); }, 1);
//                 },
//                 searchAllClue(){
//                     var json = this.addClue;
//                     for(var key in json) {
//                         if(json[key] == '') {
//                             delete json[key];
//                         }
//                     }
//                     json.ID = this.GLXSID.join();
//                     this.seriesCaseParams = json;
//                     setTimeout(() => { this.$refs['seriesClue'].init(); }, 1);
//                 },
				searchAllRelate(formname,tablename){
				    var json = this[formname];
				    for(var key in json) {
				        if(json[key] == '') {
				            delete json[key];
				        }
				    }
				    json.ID = this.GLXSID.join();
				    this.seriesCaseParams = json;
				    setTimeout(() => { this.$refs[tablename].init(); }, 1);
				},
				searchAllCase() {
				    this.searchAllRelate('addaj','seriesCase');
				},
				searchAllClue(){
				    this.searchAllRelate('addClue','seriesClue');
				},
				searchAllPerson(){
				    this.searchAllRelate('addPerson','seriesPerson');
				},
				searchAllGoods(){
				    this.searchAllRelate('addGoods','seriesGoods');
				},
                getEscapee(){
                    this.addEscapee=true;
                    this.$refs.EscapeeTab.init();
                },
                searchEscapee(){
                    this.$refs.EscapeeTab.init();
                },
//                 addToEscapee(){
//                     var _this = this;
//                     let check = this.$refs.EscapeeTab.getSelections();
//                     let arr = [];
//                     for(var i = 0;i < check.length;i++){
//                         arr.push(check[i].ZTRYBH);
//                     }
//                     axios({
//                         url: './jd?cmd=com.awspaas.user.apps.clue.addRelevanceEscapee&sid='+sid,
//                         method: 'post',
//                         params: {
//                             "data": {
//                                 "data": {
//                                     "BO_EU_XSHB_GLTF": [{
//                                         "ZTRYBH": "T3301020000002018041091"
//                                     }]
//                                 }
//                             }
//                         }
//                     }).then(response=>{
//                         if(response.data.result=='ok'){
//                             _this.addEscapee = false;
//                             _this.escapeeCheck = arr;
//                             _this.escapeeCheckTable = true; 
//                             setTimeout(function(){
//                                 _this.$refs['relevanceEscapeeTable'].init();
//                             }, 1);  
//                             var data=response.data;
//                         }
//                     }).catch((error)=>{
//                         that.$Message.warning('系统异常，请联系工作站！');
//                         console.log(error);
//                     });
//                 },
				addToEscapee(){
				    var _this = this;
				    let idList = this.$refs.EscapeeTab.getSelectionsId();
				    if (idList.length == 0){
				        this.addEscapee = false;
				        return;                        
				    } 
				    let params = [];
				    idList.forEach((item) => {
				        params.push({
				            ZTRYBH : item,
				        });
				    });
				    axios({
				        url: './jd?cmd=com.awspaas.user.apps.clue.addRelevanceEscapee&sid='+sid,
				        method: 'post',
				        params: {
				            "json": {
				                "data": {
				                    "BO_EU_XSHB_GLTF": params
				                }
				            }
				        }
				    }).then(response=>{
				        var data = response.data;
				        if(data.result=='ok'){
				            _this.TFID = _this.TFID.concat(data.data.ID);
				            let glId = [];
				            _this.addEscapee = false;
				            _this.escapeeCheckTable = true; 
				            _this.relevanceEscapeeTable.params = {"gl.ID":_this.TFID.join()};
				            setTimeout(function(){
				                _this.$refs['relevanceEscapeeTable'].init();
				            }, 1);  
				        }
				    }).catch((error)=>{
				        console.log(error);
				    });
				},
                //更新物流信息
                uploadLogistics(){
                    var _this = this;
                    for(var key in vm.temp){
                        if(vm.temp[key] == ''){
                            delete vm.temp[key]
                        }
						if(key == 'DDSJ' || key == 'SDSJ' || key == 'SHSJ'){
							if(vm.temp[key] != '' && vm.temp[key] != null && vm.temp[key] != undefined){
								vm.temp[key] = format(this.temp[key],'yyyy-MM-dd HH:mm:ss');
							}
						}
                    };
                    var json = {
                        "json":{
                            "data": {
                                "BO_EU_XSHB_GLWL": vm.temp,
                                "PCH":sessionStorage.getItem('uploadPCH')
                            }
                        }
                    }
                    json.json.data['BO_EU_XSHB_GLWL'].ID = sessionStorage.getItem('uploadId');
                    axios({
                        url:'./jd?cmd=com.awspaas.user.apps.clue.updateRelevanceLogistics&sid='+sid,
                        method: 'post',
                        params:json,
                    }).then(response=>{
                        var data=response.data;
                        if(data.result == 'ok'){
                            setTimeout(function(){
                                _this.$refs['logisticsInfo'].init();
                            }, 1); 
                        }
                    })
                },
				//点击弹框回到线索查询页面
				 backToSearchPage(){
				     window.location.href='./w?sid=<#sid>&cmd=com.awspaas.user.apps.clue.router&classify=clue&action=search';
				 },
				 //手动添加物品
				 indetifySort(value){
				     if(value=='01'){
				         this.goodsSorting = [
				             {value:"01",label:"其他可疑物品"},
				             {value:"02",label:"可疑非机动车"},
				             {value:"03",label:"可疑机动车"},
				             {value:"04",label:"可疑服务标识号"}
				         ]
				     }else{
				         this.goodsSorting = [
				             {value:"01",label:"作案工具"},
				             {value:"02",label:"作案移动通讯设备"},
				             {value:"03",label:"作案非机动车"},
				             {value:"04",label:"作案机动车"},
				             {value:"05",label:"作案卡类"},
				             {value:"06",label:"作案枪支"},
				             {value:"07",label:"作案服务标识号"}
				         ]
				     }
				},
				isChooseType(){
				    let flag = this.handleMove.SAWP;
				    if(flag == '') this.$Message.error('未选择涉案物品');
				},
				resetForm(name){
				    for(let key in this[name]){
				        this[name][key] = '';
						switch (name){
							case 'addaj':
								this.$refs.caseDepartment.handleReset();//清空子组件方法input内容
								this.$refs.caseType.handleReset();
								break;
							case 'addGoods':
								this.$refs.wpType.handleReset();
								break;
							case 'addPerson':
								this.$refs.hjdz.handleReset();
								break;
										case 'escapeeSearch':
											this.$refs.gltfhjdz.handleReset();
											break;
						}
				    }
				}
            },
			mounted() {
                var isEdit=getParameter('extendParams');
                if(isEdit!=undefined){
                    xs=JSON.parse(xs);
                    for(var key in this.newClue){
                        this.newClue[key]=xs[key];
                    }
                    let length = isEdit.length;
                    let clueType = isEdit.substring((length-6),(length-4));
					clueIds=JSON.parse(clueIds);
					debugger;
                    if(clueIds.glywIDs.length != 0){
                        this.GLXSID = clueIds.glywIDs;
                        this.seriesCheckCaseParams['gl.ID']=this.GLXSID.join();
                        this.ajcheckshow = true;
                        this.xscheckshow = true;
                        this.rycheckshow = true;
                        this.wpcheckshow = true;
                        setTimeout(() => {
                            this.$refs['seriesCheckCase'].init();
                            this.$refs['seriesCheckClue'].init();
                            this.$refs['seriesCheckPerson'].init();
                            this.$refs['seriesCheckGoods'].init();
                        }, 1);
                    };
                    if(clueType == '02'){
                        // 贩枪
                        this.wlupload = true;
                        this.logisticsTab=true;
                        this.logisticsInfo.params.PCH = clueIds.glwlID;
                        setTimeout(function(){
                            vm.$refs.logisticsInfo.init();
                        }, 1);    
                    }else if(clueType == '03'){
                         //逃犯
                        this.tfupload = true;
                        this.TFID = clueIds.gltfIDs;
                        this.escapeeCheckTable = true; 
                        this.relevanceEscapeeTable.params = {"gl.ID":this.TFID.join()};
                        setTimeout(function(){
                            vm.$refs['relevanceEscapeeTable'].init();
                        }, 1); 
                    };
					//debugger;
                    if(clueIds.fjIDs.length != 0){
                        let json = { ID:clueIds.fjIDs.join()};
                        this.searchData(json, 'com.awspaas.user.apps.clue.getRelevanceAttachment', function(response) {
                            let data = response.data;
                            if(data.result == 'ok'){
                                let rows = data.data.rows;
                                for(let i=0;i<rows.length;i++){
                                    let msg = {
                                        filePath:rows[i].FJLJ,
                                        result:'ok',
                                        id:':RO;'
                                    } 
                                    let checkFiles = {
                                        name:rows[i].FJMC,
                                        percentage: 100,
                                        response:{
                                            data:{msg:JSON.stringify(msg)},
                                            files:{
                                                size:rows[i].FJDX,
                                                name:rows[i].FJMC,
                                                role: "app"
                                            }
                                        },
                                        showProgress: false,
                                        size: rows[i].FJDX,
                                        status: "finished",
                                        uid: 1551948821278
                                    } 
									vm.filePath.push(rows[i].FJLJ)
                                    vm.$refs.upload.fileList.push(checkFiles);
                                }
                            }else{
                                console.log('error');
                            }
                        })
                    }
                    this.uploadList = this.$refs.upload.fileList;
                }
			},
		})
	</script>
	</body>
</html>